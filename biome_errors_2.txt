
> office-addin-taskpane-react@0.2.1 lint C:\Users\harsh\.gemini\antigravity\scratch\open-excel
> biome check src/

src\commands\commands.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - /*ΓÉì
     2    Γöé - ┬╖*┬╖Copyright┬╖(c)┬╖Microsoft┬╖Corporation.┬╖All┬╖rights┬╖reserved.┬╖Licensed┬╖under┬╖the┬╖MIT┬╖license.ΓÉì
     3    Γöé - ┬╖*┬╖See┬╖LICENSE┬╖in┬╖the┬╖project┬╖root┬╖for┬╖license┬╖information.ΓÉì
     4    Γöé - ┬╖*/ΓÉì
     5    Γöé - ΓÉì
     6    Γöé - /*┬╖global┬╖Office┬╖*/ΓÉì
     7    Γöé - ΓÉì
     8    Γöé - Office.onReady(()┬╖=>┬╖{ΓÉì
     9    Γöé - ┬╖┬╖//┬╖If┬╖needed,┬╖Office.js┬╖is┬╖ready┬╖to┬╖be┬╖called.ΓÉì
    10    Γöé - });ΓÉì
    11    Γöé - ΓÉì
    12    Γöé - /**ΓÉì
    13    Γöé - ┬╖*┬╖Shows┬╖a┬╖notification┬╖when┬╖the┬╖add-in┬╖command┬╖is┬╖executed.ΓÉì
    14    Γöé - ┬╖*┬╖@param┬╖eventΓÉì
    15    Γöé - ┬╖*/ΓÉì
    16    Γöé - function┬╖action(event:┬╖Office.AddinCommands.Event)┬╖{ΓÉì
    17    Γöé - ┬╖┬╖const┬╖message:┬╖Office.NotificationMessageDetails┬╖=┬╖{ΓÉì
    18    Γöé - ┬╖┬╖┬╖┬╖type:┬╖Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,ΓÉì
    19    Γöé - ┬╖┬╖┬╖┬╖message:┬╖"Performed┬╖action.",ΓÉì
    20    Γöé - ┬╖┬╖┬╖┬╖icon:┬╖"Icon.80x80",ΓÉì
    21    Γöé - ┬╖┬╖┬╖┬╖persistent:┬╖true,ΓÉì
    22    Γöé - ┬╖┬╖};ΓÉì
    23    Γöé - ΓÉì
    24    Γöé - ┬╖┬╖//┬╖Show┬╖a┬╖notification┬╖message.ΓÉì
    25    Γöé - ┬╖┬╖Office.context.mailbox.item?.notificationMessages.replaceAsync(ΓÉì
    26    Γöé - ┬╖┬╖┬╖┬╖"ActionPerformanceNotification",ΓÉì
    27    Γöé - ┬╖┬╖┬╖┬╖message,ΓÉì
    28    Γöé - ┬╖┬╖);ΓÉì
    29    Γöé - ΓÉì
    30    Γöé - ┬╖┬╖//┬╖Be┬╖sure┬╖to┬╖indicate┬╖when┬╖the┬╖add-in┬╖command┬╖function┬╖is┬╖complete.ΓÉì
    31    Γöé - ┬╖┬╖event.completed();ΓÉì
    32    Γöé - }ΓÉì
    33    Γöé - ΓÉì
    34    Γöé - //┬╖Register┬╖the┬╖function┬╖with┬╖Office.ΓÉì
    35    Γöé - Office.actions.associate("action",┬╖action);ΓÉì
        1 Γöé + /*
        2 Γöé + ┬╖*┬╖Copyright┬╖(c)┬╖Microsoft┬╖Corporation.┬╖All┬╖rights┬╖reserved.┬╖Licensed┬╖under┬╖the┬╖MIT┬╖license.
        3 Γöé + ┬╖*┬╖See┬╖LICENSE┬╖in┬╖the┬╖project┬╖root┬╖for┬╖license┬╖information.
        4 Γöé + ┬╖*/
        5 Γöé + 
        6 Γöé + /*┬╖global┬╖Office┬╖*/
        7 Γöé + 
        8 Γöé + Office.onReady(()┬╖=>┬╖{
        9 Γöé + ┬╖┬╖//┬╖If┬╖needed,┬╖Office.js┬╖is┬╖ready┬╖to┬╖be┬╖called.
       10 Γöé + });
       11 Γöé + 
       12 Γöé + /**
       13 Γöé + ┬╖*┬╖Shows┬╖a┬╖notification┬╖when┬╖the┬╖add-in┬╖command┬╖is┬╖executed.
       14 Γöé + ┬╖*┬╖@param┬╖event
       15 Γöé + ┬╖*/
       16 Γöé + function┬╖action(event:┬╖Office.AddinCommands.Event)┬╖{
       17 Γöé + ┬╖┬╖const┬╖message:┬╖Office.NotificationMessageDetails┬╖=┬╖{
       18 Γöé + ┬╖┬╖┬╖┬╖type:┬╖Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,
       19 Γöé + ┬╖┬╖┬╖┬╖message:┬╖"Performed┬╖action.",
       20 Γöé + ┬╖┬╖┬╖┬╖icon:┬╖"Icon.80x80",
       21 Γöé + ┬╖┬╖┬╖┬╖persistent:┬╖true,
       22 Γöé + ┬╖┬╖};
       23 Γöé + 
       24 Γöé + ┬╖┬╖//┬╖Show┬╖a┬╖notification┬╖message.
       25 Γöé + ┬╖┬╖Office.context.mailbox.item?.notificationMessages.replaceAsync(
       26 Γöé + ┬╖┬╖┬╖┬╖"ActionPerformanceNotification",
       27 Γöé + ┬╖┬╖┬╖┬╖message,
       28 Γöé + ┬╖┬╖);
       29 Γöé + 
       30 Γöé + ┬╖┬╖//┬╖Be┬╖sure┬╖to┬╖indicate┬╖when┬╖the┬╖add-in┬╖command┬╖function┬╖is┬╖complete.
       31 Γöé + ┬╖┬╖event.completed();
       32 Γöé + }
       33 Γöé + 
       34 Γöé + //┬╖Register┬╖the┬╖function┬╖with┬╖Office.
       35 Γöé + Office.actions.associate("action",┬╖action);
    36 36 Γöé   
  

src\global.d.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
    1   Γöé - declare┬╖const┬╖__APP_VERSION__:┬╖string;ΓÉì
      1 Γöé + declare┬╖const┬╖__APP_VERSION__:┬╖string;
    2 2 Γöé   
  

src\lib\dirty-tracker.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - /**ΓÉì
      2     Γöé - ┬╖*┬╖Dirty┬╖range┬╖tracking┬╖for┬╖Excel┬╖mutations.ΓÉì
      3     Γöé - ┬╖*┬╖Tracks┬╖which┬╖cells/ranges┬╖have┬╖been┬╖modified┬╖by┬╖tools.ΓÉì
      4     Γöé - ┬╖*/ΓÉì
      5     Γöé - ΓÉì
      6     Γöé - export┬╖interface┬╖DirtyRange┬╖{ΓÉì
      7     Γöé - ┬╖┬╖sheetId:┬╖number;ΓÉì
      8     Γöé - ┬╖┬╖range:┬╖string;┬╖//┬╖A1┬╖notation┬╖or┬╖'*'┬╖for┬╖entire┬╖sheetΓÉì
      9     Γöé - }ΓÉì
     10     Γöé - ΓÉì
     11     Γöé - /**ΓÉì
     12     Γöé - ┬╖*┬╖Normalize┬╖and┬╖merge┬╖overlapping┬╖ranges┬╖(simple┬╖implementation).ΓÉì
     13     Γöé - ┬╖*┬╖For┬╖now,┬╖just┬╖deduplicates┬╖exact┬╖matches.┬╖A┬╖full┬╖implementationΓÉì
     14     Γöé - ┬╖*┬╖would┬╖merge┬╖A1:B5┬╖+┬╖A3:C10┬╖into┬╖a┬╖bounding┬╖box.ΓÉì
     15     Γöé - ┬╖*/ΓÉì
     16     Γöé - export┬╖function┬╖mergeRanges(ranges:┬╖DirtyRange[]):┬╖DirtyRange[]┬╖{ΓÉì
     17     Γöé - ┬╖┬╖const┬╖seen┬╖=┬╖new┬╖Map<string,┬╖DirtyRange>();ΓÉì
     18     Γöé - ΓÉì
     19     Γöé - ┬╖┬╖for┬╖(const┬╖r┬╖of┬╖ranges)┬╖{ΓÉì
     20     Γöé - ┬╖┬╖┬╖┬╖//┬╖If┬╖any┬╖range┬╖is┬╖'*'┬╖for┬╖this┬╖sheet,┬╖it┬╖encompasses┬╖everythingΓÉì
     21     Γöé - ┬╖┬╖┬╖┬╖const┬╖sheetKey┬╖=┬╖String(r.sheetId);ΓÉì
     22     Γöé - ┬╖┬╖┬╖┬╖const┬╖fullKey┬╖=┬╖`${r.sheetId}:${r.range}`;ΓÉì
     23     Γöé - ΓÉì
     24     Γöé - ┬╖┬╖┬╖┬╖if┬╖(r.range┬╖===┬╖"*")┬╖{ΓÉì
     25     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Remove┬╖all┬╖other┬╖ranges┬╖for┬╖this┬╖sheet,┬╖replace┬╖with┬╖'*'ΓÉì
     26     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖keysToDelete┬╖=┬╖Array.from(seen.keys()).filter((key)┬╖=>ΓÉì
     27     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖key.startsWith(`${sheetKey}:`),ΓÉì
     28     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖);ΓÉì
     29     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖for┬╖(const┬╖key┬╖of┬╖keysToDelete)┬╖{ΓÉì
     30     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖seen.delete(key);ΓÉì
     31     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     32     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖seen.set(`${sheetKey}:*`,┬╖r);ΓÉì
     33     Γöé - ┬╖┬╖┬╖┬╖}┬╖else┬╖if┬╖(!seen.has(`${sheetKey}:*`))┬╖{ΓÉì
     34     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Only┬╖add┬╖if┬╖we┬╖don't┬╖already┬╖have┬╖a┬╖wildcard┬╖for┬╖this┬╖sheetΓÉì
     35     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖seen.set(fullKey,┬╖r);ΓÉì
     36     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     37     Γöé - ┬╖┬╖}ΓÉì
     38     Γöé - ΓÉì
     39     Γöé - ┬╖┬╖return┬╖Array.from(seen.values());ΓÉì
     40     Γöé - }ΓÉì
     41     Γöé - ΓÉì
     42     Γöé - /**ΓÉì
     43     Γöé - ┬╖*┬╖Parse┬╖a┬╖range┬╖address┬╖to┬╖extract┬╖bounding┬╖box┬╖info.ΓÉì
     44     Γöé - ┬╖*┬╖Returns┬╖{┬╖startCol,┬╖startRow,┬╖endCol,┬╖endRow┬╖}┬╖as┬╖0-indexed┬╖numbers.ΓÉì
     45     Γöé - ┬╖*/ΓÉì
     46     Γöé - export┬╖function┬╖parseRange(range:┬╖string):┬╖{ΓÉì
     47     Γöé - ┬╖┬╖startCol:┬╖number;ΓÉì
     48     Γöé - ┬╖┬╖startRow:┬╖number;ΓÉì
     49     Γöé - ┬╖┬╖endCol:┬╖number;ΓÉì
     50     Γöé - ┬╖┬╖endRow:┬╖number;ΓÉì
     51     Γöé - }┬╖|┬╖null┬╖{ΓÉì
     52     Γöé - ┬╖┬╖if┬╖(range┬╖===┬╖"*")┬╖return┬╖null;ΓÉì
     53     Γöé - ΓÉì
     54     Γöé - ┬╖┬╖//┬╖Handle┬╖single┬╖cell┬╖like┬╖"A1"┬╖or┬╖range┬╖like┬╖"A1:B5"ΓÉì
     55     Γöé - ┬╖┬╖const┬╖parts┬╖=┬╖range.split(":");ΓÉì
     56     Γöé - ┬╖┬╖const┬╖start┬╖=┬╖parseCellAddress(parts[0]);ΓÉì
     57     Γöé - ┬╖┬╖const┬╖end┬╖=┬╖parts[1]┬╖?┬╖parseCellAddress(parts[1])┬╖:┬╖start;ΓÉì
     58     Γöé - ΓÉì
     59     Γöé - ┬╖┬╖if┬╖(!start┬╖||┬╖!end)┬╖return┬╖null;ΓÉì
     60     Γöé - ΓÉì
     61     Γöé - ┬╖┬╖return┬╖{ΓÉì
     62     Γöé - ┬╖┬╖┬╖┬╖startCol:┬╖Math.min(start.col,┬╖end.col),ΓÉì
     63     Γöé - ┬╖┬╖┬╖┬╖startRow:┬╖Math.min(start.row,┬╖end.row),ΓÉì
     64     Γöé - ┬╖┬╖┬╖┬╖endCol:┬╖Math.max(start.col,┬╖end.col),ΓÉì
     65     Γöé - ┬╖┬╖┬╖┬╖endRow:┬╖Math.max(start.row,┬╖end.row),ΓÉì
     66     Γöé - ┬╖┬╖};ΓÉì
     67     Γöé - }ΓÉì
     68     Γöé - ΓÉì
     69     Γöé - function┬╖parseCellAddress(addr:┬╖string):┬╖{┬╖col:┬╖number;┬╖row:┬╖number┬╖}┬╖|┬╖null┬╖{ΓÉì
     70     Γöé - ┬╖┬╖const┬╖match┬╖=┬╖addr.match(/^([A-Z]+)(\d+)$/i);ΓÉì
     71     Γöé - ┬╖┬╖if┬╖(!match)┬╖return┬╖null;ΓÉì
     72     Γöé - ΓÉì
     73     Γöé - ┬╖┬╖const┬╖colStr┬╖=┬╖match[1].toUpperCase();ΓÉì
     74     Γöé - ┬╖┬╖const┬╖row┬╖=┬╖parseInt(match[2],┬╖10)┬╖-┬╖1;ΓÉì
     75     Γöé - ΓÉì
     76     Γöé - ┬╖┬╖let┬╖col┬╖=┬╖0;ΓÉì
     77     Γöé - ┬╖┬╖for┬╖(let┬╖i┬╖=┬╖0;┬╖i┬╖<┬╖colStr.length;┬╖i++)┬╖{ΓÉì
     78     Γöé - ┬╖┬╖┬╖┬╖col┬╖=┬╖col┬╖*┬╖26┬╖+┬╖(colStr.charCodeAt(i)┬╖-┬╖64);ΓÉì
     79     Γöé - ┬╖┬╖}ΓÉì
     80     Γöé - ┬╖┬╖col┬╖-=┬╖1;ΓÉì
     81     Γöé - ΓÉì
     82     Γöé - ┬╖┬╖return┬╖{┬╖col,┬╖row┬╖};ΓÉì
     83     Γöé - }ΓÉì
     84     Γöé - ΓÉì
     85     Γöé - /**ΓÉì
     86     Γöé - ┬╖*┬╖Format┬╖dirty┬╖ranges┬╖for┬╖display┬╖in┬╖tool┬╖results.ΓÉì
     87     Γöé - ┬╖*/ΓÉì
     88     Γöé - export┬╖function┬╖formatDirtyRanges(ΓÉì
     89     Γöé - ┬╖┬╖ranges:┬╖DirtyRange[],ΓÉì
     90     Γöé - ┬╖┬╖sheetNameLookup?:┬╖(sheetId:┬╖number)┬╖=>┬╖string┬╖|┬╖undefined,ΓÉì
     91     Γöé - ):┬╖string┬╖{ΓÉì
     92     Γöé - ┬╖┬╖if┬╖(ranges.length┬╖===┬╖0)┬╖return┬╖"";ΓÉì
     93     Γöé - ΓÉì
     94     Γöé - ┬╖┬╖const┬╖merged┬╖=┬╖mergeRanges(ranges);ΓÉì
     95     Γöé - ΓÉì
     96     Γöé - ┬╖┬╖return┬╖mergedΓÉì
     97     Γöé - ┬╖┬╖┬╖┬╖.map((r)┬╖=>┬╖{ΓÉì
     98     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖sheetName┬╖=┬╖sheetNameLookup?.(r.sheetId);ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖sheetDisplay┬╖=┬╖sheetName┬╖||┬╖`Sheet┬╖${r.sheetId}`;ΓÉì
    100     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(r.range┬╖===┬╖"*")┬╖{ΓÉì
    101     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖`${sheetDisplay}┬╖(all)`;ΓÉì
    102     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    103     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖`${sheetDisplay}!${r.range}`;ΓÉì
    104     Γöé - ┬╖┬╖┬╖┬╖})ΓÉì
    105     Γöé - ┬╖┬╖┬╖┬╖.join(",┬╖");ΓÉì
    106     Γöé - }ΓÉì
          1 Γöé + /**
          2 Γöé + ┬╖*┬╖Dirty┬╖range┬╖tracking┬╖for┬╖Excel┬╖mutations.
          3 Γöé + ┬╖*┬╖Tracks┬╖which┬╖cells/ranges┬╖have┬╖been┬╖modified┬╖by┬╖tools.
          4 Γöé + ┬╖*/
          5 Γöé + 
          6 Γöé + export┬╖interface┬╖DirtyRange┬╖{
          7 Γöé + ┬╖┬╖sheetId:┬╖number;
          8 Γöé + ┬╖┬╖range:┬╖string;┬╖//┬╖A1┬╖notation┬╖or┬╖'*'┬╖for┬╖entire┬╖sheet
          9 Γöé + }
         10 Γöé + 
         11 Γöé + /**
         12 Γöé + ┬╖*┬╖Normalize┬╖and┬╖merge┬╖overlapping┬╖ranges┬╖(simple┬╖implementation).
         13 Γöé + ┬╖*┬╖For┬╖now,┬╖just┬╖deduplicates┬╖exact┬╖matches.┬╖A┬╖full┬╖implementation
         14 Γöé + ┬╖*┬╖would┬╖merge┬╖A1:B5┬╖+┬╖A3:C10┬╖into┬╖a┬╖bounding┬╖box.
         15 Γöé + ┬╖*/
         16 Γöé + export┬╖function┬╖mergeRanges(ranges:┬╖DirtyRange[]):┬╖DirtyRange[]┬╖{
         17 Γöé + ┬╖┬╖const┬╖seen┬╖=┬╖new┬╖Map<string,┬╖DirtyRange>();
         18 Γöé + 
         19 Γöé + ┬╖┬╖for┬╖(const┬╖r┬╖of┬╖ranges)┬╖{
         20 Γöé + ┬╖┬╖┬╖┬╖//┬╖If┬╖any┬╖range┬╖is┬╖'*'┬╖for┬╖this┬╖sheet,┬╖it┬╖encompasses┬╖everything
         21 Γöé + ┬╖┬╖┬╖┬╖const┬╖sheetKey┬╖=┬╖String(r.sheetId);
         22 Γöé + ┬╖┬╖┬╖┬╖const┬╖fullKey┬╖=┬╖`${r.sheetId}:${r.range}`;
         23 Γöé + 
         24 Γöé + ┬╖┬╖┬╖┬╖if┬╖(r.range┬╖===┬╖"*")┬╖{
         25 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Remove┬╖all┬╖other┬╖ranges┬╖for┬╖this┬╖sheet,┬╖replace┬╖with┬╖'*'
         26 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖keysToDelete┬╖=┬╖Array.from(seen.keys()).filter((key)┬╖=>
         27 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖key.startsWith(`${sheetKey}:`),
         28 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖);
         29 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖for┬╖(const┬╖key┬╖of┬╖keysToDelete)┬╖{
         30 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖seen.delete(key);
         31 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}
         32 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖seen.set(`${sheetKey}:*`,┬╖r);
         33 Γöé + ┬╖┬╖┬╖┬╖}┬╖else┬╖if┬╖(!seen.has(`${sheetKey}:*`))┬╖{
         34 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Only┬╖add┬╖if┬╖we┬╖don't┬╖already┬╖have┬╖a┬╖wildcard┬╖for┬╖this┬╖sheet
         35 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖seen.set(fullKey,┬╖r);
         36 Γöé + ┬╖┬╖┬╖┬╖}
         37 Γöé + ┬╖┬╖}
         38 Γöé + 
         39 Γöé + ┬╖┬╖return┬╖Array.from(seen.values());
         40 Γöé + }
         41 Γöé + 
         42 Γöé + /**
         43 Γöé + ┬╖*┬╖Parse┬╖a┬╖range┬╖address┬╖to┬╖extract┬╖bounding┬╖box┬╖info.
         44 Γöé + ┬╖*┬╖Returns┬╖{┬╖startCol,┬╖startRow,┬╖endCol,┬╖endRow┬╖}┬╖as┬╖0-indexed┬╖numbers.
  63 more lines truncated
  

src\lib\excel\index.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - export┬╖{ΓÉì
     2    Γöé - ┬╖┬╖type┬╖CellData,ΓÉì
     3    Γöé - ┬╖┬╖type┬╖CellInput,ΓÉì
     4    Γöé - ┬╖┬╖type┬╖CellStyle,ΓÉì
     5    Γöé - ┬╖┬╖type┬╖ClearCellRangeResult,ΓÉì
     6    Γöé - ┬╖┬╖type┬╖CopyToResult,ΓÉì
     7    Γöé - ┬╖┬╖clearCellRange,ΓÉì
     8    Γöé - ┬╖┬╖copyTo,ΓÉì
     9    Γöé - ┬╖┬╖type┬╖ExcelObject,ΓÉì
    10    Γöé - ┬╖┬╖type┬╖GetAllObjectsResult,ΓÉì
    11    Γöé - ┬╖┬╖type┬╖GetCellRangesResult,ΓÉì
    12    Γöé - ┬╖┬╖type┬╖GetRangeAsCsvResult,ΓÉì
    13    Γöé - ┬╖┬╖getAllObjects,ΓÉì
    14    Γöé - ┬╖┬╖getCellRanges,ΓÉì
    15    Γöé - ┬╖┬╖getRangeAsCsv,ΓÉì
    16    Γöé - ┬╖┬╖getWorksheetById,ΓÉì
    17    Γöé - ┬╖┬╖type┬╖ModifyObjectResult,ΓÉì
    18    Γöé - ┬╖┬╖type┬╖ModifySheetStructureResult,ΓÉì
    19    Γöé - ┬╖┬╖type┬╖ModifyWorkbookStructureResult,ΓÉì
    20    Γöé - ┬╖┬╖modifyObject,ΓÉì
    21    Γöé - ┬╖┬╖modifySheetStructure,ΓÉì
    22    Γöé - ┬╖┬╖modifyWorkbookStructure,ΓÉì
    23    Γöé - ┬╖┬╖type┬╖ResizeRangeResult,ΓÉì
    24    Γöé - ┬╖┬╖resizeRange,ΓÉì
    25    Γöé - ┬╖┬╖type┬╖SearchDataResult,ΓÉì
    26    Γöé - ┬╖┬╖type┬╖SearchMatch,ΓÉì
    27    Γöé - ┬╖┬╖type┬╖SetCellRangeResult,ΓÉì
    28    Γöé - ┬╖┬╖searchData,ΓÉì
    29    Γöé - ┬╖┬╖setCellRange,ΓÉì
    30    Γöé - ┬╖┬╖type┬╖WorksheetInfo,ΓÉì
    31    Γöé - }┬╖from┬╖"./api";ΓÉì
        1 Γöé + export┬╖{
        2 Γöé + ┬╖┬╖type┬╖CellData,
        3 Γöé + ┬╖┬╖type┬╖CellInput,
        4 Γöé + ┬╖┬╖type┬╖CellStyle,
        5 Γöé + ┬╖┬╖type┬╖ClearCellRangeResult,
        6 Γöé + ┬╖┬╖type┬╖CopyToResult,
        7 Γöé + ┬╖┬╖clearCellRange,
        8 Γöé + ┬╖┬╖copyTo,
        9 Γöé + ┬╖┬╖type┬╖ExcelObject,
       10 Γöé + ┬╖┬╖type┬╖GetAllObjectsResult,
       11 Γöé + ┬╖┬╖type┬╖GetCellRangesResult,
       12 Γöé + ┬╖┬╖type┬╖GetRangeAsCsvResult,
       13 Γöé + ┬╖┬╖getAllObjects,
       14 Γöé + ┬╖┬╖getCellRanges,
       15 Γöé + ┬╖┬╖getRangeAsCsv,
       16 Γöé + ┬╖┬╖getWorksheetById,
       17 Γöé + ┬╖┬╖type┬╖ModifyObjectResult,
       18 Γöé + ┬╖┬╖type┬╖ModifySheetStructureResult,
       19 Γöé + ┬╖┬╖type┬╖ModifyWorkbookStructureResult,
       20 Γöé + ┬╖┬╖modifyObject,
       21 Γöé + ┬╖┬╖modifySheetStructure,
       22 Γöé + ┬╖┬╖modifyWorkbookStructure,
       23 Γöé + ┬╖┬╖type┬╖ResizeRangeResult,
       24 Γöé + ┬╖┬╖resizeRange,
       25 Γöé + ┬╖┬╖type┬╖SearchDataResult,
       26 Γöé + ┬╖┬╖type┬╖SearchMatch,
       27 Γöé + ┬╖┬╖type┬╖SetCellRangeResult,
       28 Γöé + ┬╖┬╖searchData,
       29 Γöé + ┬╖┬╖setCellRange,
       30 Γöé + ┬╖┬╖type┬╖WorksheetInfo,
       31 Γöé + }┬╖from┬╖"./api";
    32 32 Γöé   
  

src\lib\excel\sheet-id-map.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - /*┬╖global┬╖Office┬╖*/ΓÉì
      2     Γöé - ΓÉì
      3     Γöé - const┬╖SETTINGS_KEY_MAP┬╖=┬╖"openexcel-sheet-id-map";ΓÉì
      4     Γöé - const┬╖SETTINGS_KEY_COUNTER┬╖=┬╖"openexcel-sheet-id-counter";ΓÉì
      5     Γöé - ΓÉì
      6     Γöé - interface┬╖SheetIdMap┬╖{ΓÉì
      7     Γöé - ┬╖┬╖[guid:┬╖string]:┬╖number;ΓÉì
      8     Γöé - }ΓÉì
      9     Γöé - ΓÉì
     10     Γöé - let┬╖cachedMap:┬╖SheetIdMap┬╖|┬╖null┬╖=┬╖null;ΓÉì
     11     Γöé - let┬╖cachedCounter:┬╖number┬╖|┬╖null┬╖=┬╖null;ΓÉì
     12     Γöé - let┬╖isDirty┬╖=┬╖false;ΓÉì
     13     Γöé - ΓÉì
     14     Γöé - async┬╖function┬╖loadFromSettings():┬╖Promise<void>┬╖{ΓÉì
     15     Γöé - ┬╖┬╖return┬╖new┬╖Promise((resolve)┬╖=>┬╖{ΓÉì
     16     Γöé - ┬╖┬╖┬╖┬╖Office.context.document.settings.refreshAsync(()┬╖=>┬╖{ΓÉì
     17     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖cachedMap┬╖=┬╖Office.context.document.settings.get(SETTINGS_KEY_MAP)┬╖||┬╖{};ΓÉì
     18     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖cachedCounter┬╖=ΓÉì
     19     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Office.context.document.settings.get(SETTINGS_KEY_COUNTER)┬╖||┬╖0;ΓÉì
     20     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖resolve();ΓÉì
     21     Γöé - ┬╖┬╖┬╖┬╖});ΓÉì
     22     Γöé - ┬╖┬╖});ΓÉì
     23     Γöé - }ΓÉì
     24     Γöé - ΓÉì
     25     Γöé - async┬╖function┬╖saveToSettings():┬╖Promise<void>┬╖{ΓÉì
     26     Γöé - ┬╖┬╖if┬╖(!isDirty)┬╖return;ΓÉì
     27     Γöé - ΓÉì
     28     Γöé - ┬╖┬╖return┬╖new┬╖Promise((resolve)┬╖=>┬╖{ΓÉì
     29     Γöé - ┬╖┬╖┬╖┬╖Office.context.document.settings.set(SETTINGS_KEY_MAP,┬╖cachedMap);ΓÉì
     30     Γöé - ┬╖┬╖┬╖┬╖Office.context.document.settings.set(SETTINGS_KEY_COUNTER,┬╖cachedCounter);ΓÉì
     31     Γöé - ┬╖┬╖┬╖┬╖Office.context.document.settings.saveAsync(()┬╖=>┬╖{ΓÉì
     32     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖isDirty┬╖=┬╖false;ΓÉì
     33     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖resolve();ΓÉì
     34     Γöé - ┬╖┬╖┬╖┬╖});ΓÉì
     35     Γöé - ┬╖┬╖});ΓÉì
     36     Γöé - }ΓÉì
     37     Γöé - ΓÉì
     38     Γöé - export┬╖async┬╖function┬╖getStableSheetId(guid:┬╖string):┬╖Promise<number>┬╖{ΓÉì
     39     Γöé - ┬╖┬╖if┬╖(cachedMap┬╖===┬╖null)┬╖{ΓÉì
     40     Γöé - ┬╖┬╖┬╖┬╖await┬╖loadFromSettings();ΓÉì
     41     Γöé - ┬╖┬╖}ΓÉì
     42     Γöé - ΓÉì
     43     Γöé - ┬╖┬╖if┬╖(cachedMap![guid])┬╖{ΓÉì
     44     Γöé - ┬╖┬╖┬╖┬╖return┬╖cachedMap![guid];ΓÉì
     45     Γöé - ┬╖┬╖}ΓÉì
     46     Γöé - ΓÉì
     47     Γöé - ┬╖┬╖cachedCounter┬╖=┬╖(cachedCounter┬╖||┬╖0)┬╖+┬╖1;ΓÉì
     48     Γöé - ┬╖┬╖cachedMap![guid]┬╖=┬╖cachedCounter;ΓÉì
     49     Γöé - ┬╖┬╖isDirty┬╖=┬╖true;ΓÉì
     50     Γöé - ┬╖┬╖await┬╖saveToSettings();ΓÉì
     51     Γöé - ΓÉì
     52     Γöé - ┬╖┬╖return┬╖cachedCounter;ΓÉì
     53     Γöé - }ΓÉì
     54     Γöé - ΓÉì
     55     Γöé - export┬╖function┬╖getExistingSheetId(guid:┬╖string):┬╖number┬╖|┬╖null┬╖{ΓÉì
     56     Γöé - ┬╖┬╖if┬╖(cachedMap┬╖===┬╖null)┬╖return┬╖null;ΓÉì
     57     Γöé - ┬╖┬╖return┬╖cachedMap[guid]┬╖||┬╖null;ΓÉì
     58     Γöé - }ΓÉì
     59     Γöé - ΓÉì
     60     Γöé - export┬╖async┬╖function┬╖getAllSheetIds():┬╖Promise<SheetIdMap>┬╖{ΓÉì
     61     Γöé - ┬╖┬╖if┬╖(cachedMap┬╖===┬╖null)┬╖{ΓÉì
     62     Γöé - ┬╖┬╖┬╖┬╖await┬╖loadFromSettings();ΓÉì
     63     Γöé - ┬╖┬╖}ΓÉì
     64     Γöé - ┬╖┬╖return┬╖{┬╖...cachedMap!┬╖};ΓÉì
     65     Γöé - }ΓÉì
     66     Γöé - ΓÉì
     67     Γöé - export┬╖async┬╖function┬╖clearSheetIds():┬╖Promise<void>┬╖{ΓÉì
     68     Γöé - ┬╖┬╖cachedMap┬╖=┬╖{};ΓÉì
     69     Γöé - ┬╖┬╖cachedCounter┬╖=┬╖0;ΓÉì
     70     Γöé - ┬╖┬╖isDirty┬╖=┬╖true;ΓÉì
     71     Γöé - ┬╖┬╖await┬╖saveToSettings();ΓÉì
     72     Γöé - }ΓÉì
     73     Γöé - ΓÉì
     74     Γöé - export┬╖async┬╖function┬╖preloadSheetIds(ΓÉì
     75     Γöé - ┬╖┬╖worksheets:┬╖Excel.Worksheet[],ΓÉì
     76     Γöé - ):┬╖Promise<Map<string,┬╖number>>┬╖{ΓÉì
     77     Γöé - ┬╖┬╖if┬╖(cachedMap┬╖===┬╖null)┬╖{ΓÉì
     78     Γöé - ┬╖┬╖┬╖┬╖await┬╖loadFromSettings();ΓÉì
     79     Γöé - ┬╖┬╖}ΓÉì
     80     Γöé - ΓÉì
     81     Γöé - ┬╖┬╖const┬╖result┬╖=┬╖new┬╖Map<string,┬╖number>();ΓÉì
     82     Γöé - ┬╖┬╖let┬╖needsSave┬╖=┬╖false;ΓÉì
     83     Γöé - ΓÉì
     84     Γöé - ┬╖┬╖for┬╖(const┬╖sheet┬╖of┬╖worksheets)┬╖{ΓÉì
     85     Γöé - ┬╖┬╖┬╖┬╖const┬╖guid┬╖=┬╖sheet.id;ΓÉì
     86     Γöé - ΓÉì
     87     Γöé - ┬╖┬╖┬╖┬╖if┬╖(cachedMap![guid])┬╖{ΓÉì
     88     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖result.set(guid,┬╖cachedMap![guid]);ΓÉì
     89     Γöé - ┬╖┬╖┬╖┬╖}┬╖else┬╖{ΓÉì
     90     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖cachedCounter┬╖=┬╖(cachedCounter┬╖||┬╖0)┬╖+┬╖1;ΓÉì
     91     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖cachedMap![guid]┬╖=┬╖cachedCounter;ΓÉì
     92     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖result.set(guid,┬╖cachedCounter);ΓÉì
     93     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖needsSave┬╖=┬╖true;ΓÉì
     94     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     95     Γöé - ┬╖┬╖}ΓÉì
     96     Γöé - ΓÉì
     97     Γöé - ┬╖┬╖if┬╖(needsSave)┬╖{ΓÉì
     98     Γöé - ┬╖┬╖┬╖┬╖isDirty┬╖=┬╖true;ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖await┬╖saveToSettings();ΓÉì
    100     Γöé - ┬╖┬╖}ΓÉì
    101     Γöé - ΓÉì
    102     Γöé - ┬╖┬╖return┬╖result;ΓÉì
    103     Γöé - }ΓÉì
          1 Γöé + /*┬╖global┬╖Office┬╖*/
          2 Γöé + 
          3 Γöé + const┬╖SETTINGS_KEY_MAP┬╖=┬╖"openexcel-sheet-id-map";
          4 Γöé + const┬╖SETTINGS_KEY_COUNTER┬╖=┬╖"openexcel-sheet-id-counter";
          5 Γöé + 
          6 Γöé + interface┬╖SheetIdMap┬╖{
          7 Γöé + ┬╖┬╖[guid:┬╖string]:┬╖number;
          8 Γöé + }
          9 Γöé + 
         10 Γöé + let┬╖cachedMap:┬╖SheetIdMap┬╖|┬╖null┬╖=┬╖null;
         11 Γöé + let┬╖cachedCounter:┬╖number┬╖|┬╖null┬╖=┬╖null;
         12 Γöé + let┬╖isDirty┬╖=┬╖false;
         13 Γöé + 
         14 Γöé + async┬╖function┬╖loadFromSettings():┬╖Promise<void>┬╖{
         15 Γöé + ┬╖┬╖return┬╖new┬╖Promise((resolve)┬╖=>┬╖{
         16 Γöé + ┬╖┬╖┬╖┬╖Office.context.document.settings.refreshAsync(()┬╖=>┬╖{
         17 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cachedMap┬╖=┬╖Office.context.document.settings.get(SETTINGS_KEY_MAP)┬╖||┬╖{};
         18 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cachedCounter┬╖=
         19 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Office.context.document.settings.get(SETTINGS_KEY_COUNTER)┬╖||┬╖0;
         20 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖resolve();
         21 Γöé + ┬╖┬╖┬╖┬╖});
         22 Γöé + ┬╖┬╖});
         23 Γöé + }
         24 Γöé + 
         25 Γöé + async┬╖function┬╖saveToSettings():┬╖Promise<void>┬╖{
         26 Γöé + ┬╖┬╖if┬╖(!isDirty)┬╖return;
         27 Γöé + 
         28 Γöé + ┬╖┬╖return┬╖new┬╖Promise((resolve)┬╖=>┬╖{
         29 Γöé + ┬╖┬╖┬╖┬╖Office.context.document.settings.set(SETTINGS_KEY_MAP,┬╖cachedMap);
         30 Γöé + ┬╖┬╖┬╖┬╖Office.context.document.settings.set(SETTINGS_KEY_COUNTER,┬╖cachedCounter);
         31 Γöé + ┬╖┬╖┬╖┬╖Office.context.document.settings.saveAsync(()┬╖=>┬╖{
         32 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖isDirty┬╖=┬╖false;
         33 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖resolve();
         34 Γöé + ┬╖┬╖┬╖┬╖});
         35 Γöé + ┬╖┬╖});
         36 Γöé + }
         37 Γöé + 
         38 Γöé + export┬╖async┬╖function┬╖getStableSheetId(guid:┬╖string):┬╖Promise<number>┬╖{
         39 Γöé + ┬╖┬╖if┬╖(cachedMap┬╖===┬╖null)┬╖{
         40 Γöé + ┬╖┬╖┬╖┬╖await┬╖loadFromSettings();
         41 Γöé + ┬╖┬╖}
         42 Γöé + 
         43 Γöé + ┬╖┬╖if┬╖(cachedMap![guid])┬╖{
         44 Γöé + ┬╖┬╖┬╖┬╖return┬╖cachedMap![guid];
         45 Γöé + ┬╖┬╖}
         46 Γöé + 
         47 Γöé + ┬╖┬╖cachedCounter┬╖=┬╖(cachedCounter┬╖||┬╖0)┬╖+┬╖1;
  57 more lines truncated
  

src\lib\excel\tracked-context.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - /*┬╖global┬╖Excel┬╖*/ΓÉì
      2     Γöé - ΓÉì
      3     Γöé - import┬╖type┬╖{┬╖DirtyRange┬╖}┬╖from┬╖"../dirty-tracker";ΓÉì
      4     Γöé - import┬╖{┬╖getStableSheetId┬╖}┬╖from┬╖"./sheet-id-map";ΓÉì
      5     Γöé - ΓÉì
      6     Γöé - /**ΓÉì
      7     Γöé - ┬╖*┬╖Creates┬╖a┬╖tracked┬╖Excel┬╖context┬╖that┬╖monitors┬╖mutations┬╖for┬╖dirty┬╖tracking.ΓÉì
      8     Γöé - ┬╖*┬╖Uses┬╖Proxies┬╖to┬╖intercept┬╖property┬╖assignments┬╖on┬╖ranges.ΓÉì
      9     Γöé - ┬╖*/ΓÉì
     10     Γöé - ΓÉì
     11     Γöé - export┬╖interface┬╖TrackedContextResult┬╖{ΓÉì
     12     Γöé - ┬╖┬╖trackedContext:┬╖Excel.RequestContext;ΓÉì
     13     Γöé - ┬╖┬╖getDirtyRanges:┬╖()┬╖=>┬╖DirtyRange[];ΓÉì
     14     Γöé - }ΓÉì
     15     Γöé - ΓÉì
     16     Γöé - //┬╖biome-ignore┬╖lint/complexity/noBannedTypes:┬╖Proxy┬╖handlers┬╖need┬╖generic┬╖function┬╖type┬╖for┬╖dynamic┬╖method┬╖interceptionΓÉì
     17     Γöé - type┬╖AnyFunction┬╖=┬╖Function;ΓÉì
     18     Γöé - ΓÉì
     19     Γöé - interface┬╖DirtyEntry┬╖{ΓÉì
     20     Γöé - ┬╖┬╖sheetIdRef:┬╖{┬╖id:┬╖number┬╖};ΓÉì
     21     Γöé - ┬╖┬╖range:┬╖string;ΓÉì
     22     Γöé - }ΓÉì
     23     Γöé - ΓÉì
     24     Γöé - interface┬╖PendingSheetRef┬╖{ΓÉì
     25     Γöé - ┬╖┬╖sheet:┬╖Excel.Worksheet;ΓÉì
     26     Γöé - ┬╖┬╖sheetIdRef:┬╖{┬╖id:┬╖number┬╖};ΓÉì
     27     Γöé - }ΓÉì
     28     Γöé - ΓÉì
     29     Γöé - /**ΓÉì
     30     Γöé - ┬╖*┬╖Create┬╖a┬╖tracked┬╖version┬╖of┬╖the┬╖Excel┬╖context┬╖that┬╖monitors┬╖mutations.ΓÉì
     31     Γöé - ┬╖*/ΓÉì
     32     Γöé - export┬╖function┬╖createTrackedContext(ΓÉì
     33     Γöé - ┬╖┬╖context:┬╖Excel.RequestContext,ΓÉì
     34     Γöé - ):┬╖TrackedContextResult┬╖{ΓÉì
     35     Γöé - ┬╖┬╖const┬╖dirtyEntries:┬╖DirtyEntry[]┬╖=┬╖[];ΓÉì
     36     Γöé - ┬╖┬╖const┬╖pendingSheetRefs:┬╖PendingSheetRef[]┬╖=┬╖[];ΓÉì
     37     Γöé - ΓÉì
     38     Γöé - ┬╖┬╖const┬╖markDirty┬╖=┬╖(sheetIdRef:┬╖{┬╖id:┬╖number┬╖},┬╖range:┬╖string)┬╖=>┬╖{ΓÉì
     39     Γöé - ┬╖┬╖┬╖┬╖dirtyEntries.push({┬╖sheetIdRef,┬╖range┬╖});ΓÉì
     40     Γöé - ┬╖┬╖};ΓÉì
     41     Γöé - ΓÉì
     42     Γöé - ┬╖┬╖//┬╖Called┬╖after┬╖each┬╖context.sync()┬╖to┬╖resolve┬╖pending┬╖sheet┬╖IDsΓÉì
     43     Γöé - ┬╖┬╖const┬╖resolvePendingSheetRefs┬╖=┬╖async┬╖()┬╖=>┬╖{ΓÉì
     44     Γöé - ┬╖┬╖┬╖┬╖if┬╖(pendingSheetRefs.length┬╖===┬╖0)┬╖return;ΓÉì
     45     Γöé - ΓÉì
     46     Γöé - ┬╖┬╖┬╖┬╖for┬╖(const┬╖pending┬╖of┬╖pendingSheetRefs)┬╖{ΓÉì
     47     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(pending.sheetIdRef.id┬╖!==┬╖-1)┬╖continue;┬╖//┬╖Already┬╖resolvedΓÉì
     48     Γöé - ΓÉì
     49     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖try┬╖{ΓÉì
     50     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Get┬╖the┬╖stable┬╖ID┬╖for┬╖this┬╖sheet┬╖(persisted┬╖in┬╖document┬╖settings)ΓÉì
     51     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖pending.sheet.load("id");ΓÉì
     52     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖await┬╖context.sync();ΓÉì
     53     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖pending.sheetIdRef.id┬╖=┬╖await┬╖getStableSheetId(pending.sheet.id);ΓÉì
     54     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}┬╖catch┬╖{ΓÉì
     55     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Failed┬╖to┬╖resolve,┬╖will┬╖remain┬╖-1ΓÉì
     56     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     57     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     58     Γöé - ┬╖┬╖};ΓÉì
     59     Γöé - ΓÉì
     60     Γöé - ┬╖┬╖//┬╖Helper┬╖to┬╖get┬╖clean┬╖address┬╖from┬╖rangeΓÉì
     61     Γöé - ┬╖┬╖const┬╖getCleanAddr┬╖=┬╖(target:┬╖any):┬╖string┬╖=>┬╖{ΓÉì
     62     Γöé - ┬╖┬╖┬╖┬╖const┬╖addr┬╖=┬╖target.m_address┬╖||┬╖target._address┬╖||┬╖"*";ΓÉì
     63     Γöé - ┬╖┬╖┬╖┬╖return┬╖typeof┬╖addr┬╖===┬╖"string"┬╖?┬╖addr.split("!").pop()┬╖||┬╖"*"┬╖:┬╖"*";ΓÉì
     64     Γöé - ┬╖┬╖};ΓÉì
     65     Γöé - ΓÉì
     66     Γöé - ┬╖┬╖const┬╖createTrackedRangeWithRef┬╖=┬╖(ΓÉì
     67     Γöé - ┬╖┬╖┬╖┬╖range:┬╖Excel.Range,ΓÉì
     68     Γöé - ┬╖┬╖┬╖┬╖sheetIdRef:┬╖{┬╖id:┬╖number┬╖},ΓÉì
     69     Γöé - ┬╖┬╖┬╖┬╖knownAddress?:┬╖string,ΓÉì
     70     Γöé - ┬╖┬╖):┬╖Excel.Range┬╖=>┬╖{ΓÉì
     71     Γöé - ┬╖┬╖┬╖┬╖//┬╖Use┬╖the┬╖known┬╖address┬╖if┬╖provided,┬╖otherwise┬╖try┬╖to┬╖get┬╖it┬╖from┬╖the┬╖rangeΓÉì
     72     Γöé - ┬╖┬╖┬╖┬╖const┬╖getAddress┬╖=┬╖():┬╖string┬╖=>┬╖{ΓÉì
     73     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(knownAddress)┬╖return┬╖knownAddress;ΓÉì
     74     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖getCleanAddr(range);ΓÉì
     75     Γöé - ┬╖┬╖┬╖┬╖};ΓÉì
     76     Γöé - ΓÉì
     77     Γöé - ┬╖┬╖┬╖┬╖return┬╖new┬╖Proxy(range,┬╖{ΓÉì
     78     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖set(target,┬╖prop,┬╖value)┬╖{ΓÉì
     79     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Track┬╖mutations┬╖to┬╖values,┬╖formulas,┬╖numberFormatΓÉì
     80     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(ΓÉì
     81     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"values"┬╖||ΓÉì
     82     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"formulas"┬╖||ΓÉì
     83     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"numberFormat"ΓÉì
     84     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖)┬╖{ΓÉì
     85     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖markDirty(sheetIdRef,┬╖getAddress());ΓÉì
     86     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     87     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖(target┬╖as┬╖any)[prop]┬╖=┬╖value;ΓÉì
     88     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖true;ΓÉì
     89     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖},ΓÉì
     90     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖get(target,┬╖prop)┬╖{ΓÉì
     91     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖value┬╖=┬╖(target┬╖as┬╖any)[prop];ΓÉì
     92     Γöé - ΓÉì
     93     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Wrap┬╖methods┬╖that┬╖return┬╖ranges┬╖(these┬╖create┬╖new┬╖ranges,┬╖address┬╖unknown)ΓÉì
     94     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(ΓÉì
     95     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"getCell"┬╖||ΓÉì
     96     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"getColumn"┬╖||ΓÉì
     97     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"getRow"┬╖||ΓÉì
     98     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖prop┬╖===┬╖"getResizedRange"ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖)┬╖{ΓÉì
    100     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(...args:┬╖any[])┬╖=>┬╖{ΓÉì
    101     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖(value┬╖as┬╖AnyFunction).apply(target,┬╖args);ΓÉì
    102     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖createTrackedRangeWithRef(result,┬╖sheetIdRef);┬╖//┬╖No┬╖known┬╖addressΓÉì
    103     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
    104     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    105     Γöé - ΓÉì
    106     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Track┬╖clear()┬╖callsΓÉì
    107     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(prop┬╖===┬╖"clear")┬╖{ΓÉì
    108     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(...args:┬╖any[])┬╖=>┬╖{ΓÉì
    109     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖markDirty(sheetIdRef,┬╖getAddress());ΓÉì
    110     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(value┬╖as┬╖AnyFunction).apply(target,┬╖args);ΓÉì
    111     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
    112     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    113     Γöé - ΓÉì
    114     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Track┬╖delete()┬╖callsΓÉì
    115     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(prop┬╖===┬╖"delete")┬╖{ΓÉì
    116     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(...args:┬╖any[])┬╖=>┬╖{ΓÉì
    117     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖markDirty(sheetIdRef,┬╖"*");┬╖//┬╖Deletion┬╖affects┬╖everything┬╖below/rightΓÉì
    118     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(value┬╖as┬╖AnyFunction).apply(target,┬╖args);ΓÉì
    119     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
    120     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    121     Γöé - ΓÉì
    122     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Track┬╖insert()┬╖callsΓÉì
    123     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(prop┬╖===┬╖"insert")┬╖{ΓÉì
    124     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(...args:┬╖any[])┬╖=>┬╖{ΓÉì
    125     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖markDirty(sheetIdRef,┬╖"*");┬╖//┬╖Insertion┬╖affects┬╖everything┬╖below/rightΓÉì
    126     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(value┬╖as┬╖AnyFunction).apply(target,┬╖args);ΓÉì
    127     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
    128     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    129     Γöé - ΓÉì
    130     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Track┬╖copyFrom()┬╖callsΓÉì
    131     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(prop┬╖===┬╖"copyFrom")┬╖{ΓÉì
    132     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(...args:┬╖any[])┬╖=>┬╖{ΓÉì
    133     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖markDirty(sheetIdRef,┬╖getAddress());ΓÉì
    134     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖(value┬╖as┬╖AnyFunction).apply(target,┬╖args);ΓÉì
    135     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
    136     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    137     Γöé - ΓÉì
    138     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Wrap┬╖format┬╖property┬╖for┬╖tracking┬╖style┬╖changesΓÉì
    139     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(prop┬╖===┬╖"format")┬╖{ΓÉì
    140     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖createTrackedFormatWithRef(ΓÉì
    141     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖value,ΓÉì
    142     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖sheetIdRef,ΓÉì
    143     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖range,ΓÉì
    144     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖knownAddress,ΓÉì
    145     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖);ΓÉì
    146     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    147     Γöé - ΓÉì
    148     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(typeof┬╖value┬╖===┬╖"function")┬╖{ΓÉì
    149     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖value.bind(target);ΓÉì
    150     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
  711 more lines truncated
  

src\lib\message-utils.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - import┬╖type┬╖{┬╖AgentMessage┬╖}┬╖from┬╖"@mariozechner/pi-agent-core";ΓÉì
      2     Γöé - import┬╖type┬╖{ΓÉì
      3     Γöé - ┬╖┬╖AssistantMessage,ΓÉì
      4     Γöé - ┬╖┬╖TextContent,ΓÉì
      5     Γöé - ┬╖┬╖ToolResultMessage,ΓÉì
      6     Γöé - ┬╖┬╖UserMessage,ΓÉì
      7     Γöé - }┬╖from┬╖"@mariozechner/pi-ai";ΓÉì
      8     Γöé - ΓÉì
      9     Γöé - export┬╖type┬╖ToolCallStatus┬╖=┬╖"pending"┬╖|┬╖"running"┬╖|┬╖"complete"┬╖|┬╖"error";ΓÉì
     10     Γöé - ΓÉì
     11     Γöé - export┬╖type┬╖MessagePart┬╖=ΓÉì
     12     Γöé - ┬╖┬╖|┬╖{┬╖type:┬╖"text";┬╖text:┬╖string┬╖}ΓÉì
     13     Γöé - ┬╖┬╖|┬╖{┬╖type:┬╖"thinking";┬╖thinking:┬╖string┬╖}ΓÉì
     14     Γöé - ┬╖┬╖|┬╖{ΓÉì
     15     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖type:┬╖"toolCall";ΓÉì
     16     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖id:┬╖string;ΓÉì
     17     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖name:┬╖string;ΓÉì
     18     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖args:┬╖Record<string,┬╖unknown>;ΓÉì
     19     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖status:┬╖ToolCallStatus;ΓÉì
     20     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖result?:┬╖string;ΓÉì
     21     Γöé - ┬╖┬╖┬╖┬╖};ΓÉì
     22     Γöé - ΓÉì
     23     Γöé - export┬╖interface┬╖ChatMessage┬╖{ΓÉì
     24     Γöé - ┬╖┬╖id:┬╖string;ΓÉì
     25     Γöé - ┬╖┬╖role:┬╖"user"┬╖|┬╖"assistant";ΓÉì
     26     Γöé - ┬╖┬╖parts:┬╖MessagePart[];ΓÉì
     27     Γöé - ┬╖┬╖timestamp:┬╖number;ΓÉì
     28     Γöé - }ΓÉì
     29     Γöé - ΓÉì
     30     Γöé - export┬╖interface┬╖SessionStats┬╖{ΓÉì
     31     Γöé - ┬╖┬╖inputTokens:┬╖number;ΓÉì
     32     Γöé - ┬╖┬╖outputTokens:┬╖number;ΓÉì
     33     Γöé - ┬╖┬╖cacheRead:┬╖number;ΓÉì
     34     Γöé - ┬╖┬╖cacheWrite:┬╖number;ΓÉì
     35     Γöé - ┬╖┬╖totalCost:┬╖number;ΓÉì
     36     Γöé - ┬╖┬╖contextWindow:┬╖number;ΓÉì
     37     Γöé - ┬╖┬╖lastInputTokens:┬╖number;ΓÉì
     38     Γöé - }ΓÉì
     39     Γöé - ΓÉì
     40     Γöé - export┬╖function┬╖stripEnrichment(ΓÉì
     41     Γöé - ┬╖┬╖content:┬╖string┬╖|┬╖{┬╖type:┬╖string;┬╖text?:┬╖string┬╖}[],ΓÉì
     42     Γöé - ):┬╖string┬╖{ΓÉì
     43     Γöé - ┬╖┬╖let┬╖text:┬╖string;ΓÉì
     44     Γöé - ┬╖┬╖if┬╖(typeof┬╖content┬╖===┬╖"string")┬╖{ΓÉì
     45     Γöé - ┬╖┬╖┬╖┬╖text┬╖=┬╖content;ΓÉì
     46     Γöé - ┬╖┬╖}┬╖else┬╖{ΓÉì
     47     Γöé - ┬╖┬╖┬╖┬╖text┬╖=┬╖contentΓÉì
     48     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖.filter((c)┬╖=>┬╖c.type┬╖===┬╖"text")ΓÉì
     49     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖.map((c)┬╖=>┬╖c.text┬╖??┬╖"")ΓÉì
     50     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖.join("\n");ΓÉì
     51     Γöé - ┬╖┬╖}ΓÉì
     52     Γöé - ┬╖┬╖text┬╖=┬╖text.replace(/^<attachments>\n[\s\S]*?\n<\/attachments>\n\n/,┬╖"");ΓÉì
     53     Γöé - ┬╖┬╖text┬╖=┬╖text.replace(/^<wb_context>\n[\s\S]*?\n<\/wb_context>\n\n/,┬╖"");ΓÉì
     54     Γöé - ┬╖┬╖return┬╖text;ΓÉì
     55     Γöé - }ΓÉì
     56     Γöé - ΓÉì
     57     Γöé - export┬╖function┬╖generateId():┬╖string┬╖{ΓÉì
     58     Γöé - ┬╖┬╖return┬╖`${Date.now()}-${Math.random().toString(36).slice(2,┬╖9)}`;ΓÉì
     59     Γöé - }ΓÉì
     60     Γöé - ΓÉì
     61     Γöé - export┬╖function┬╖extractPartsFromAssistantMessage(ΓÉì
     62     Γöé - ┬╖┬╖message:┬╖AgentMessage,ΓÉì
     63     Γöé - ┬╖┬╖existingParts:┬╖MessagePart[]┬╖=┬╖[],ΓÉì
     64     Γöé - ):┬╖MessagePart[]┬╖{ΓÉì
     65     Γöé - ┬╖┬╖if┬╖(message.role┬╖!==┬╖"assistant")┬╖return┬╖existingParts;ΓÉì
     66     Γöé - ΓÉì
     67     Γöé - ┬╖┬╖const┬╖assistantMsg┬╖=┬╖message┬╖as┬╖AssistantMessage;ΓÉì
     68     Γöé - ┬╖┬╖const┬╖existingToolCalls┬╖=┬╖new┬╖Map<string,┬╖MessagePart>();ΓÉì
     69     Γöé - ┬╖┬╖for┬╖(const┬╖part┬╖of┬╖existingParts)┬╖{ΓÉì
     70     Γöé - ┬╖┬╖┬╖┬╖if┬╖(part.type┬╖===┬╖"toolCall")┬╖{ΓÉì
     71     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖existingToolCalls.set(part.id,┬╖part);ΓÉì
     72     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     73     Γöé - ┬╖┬╖}ΓÉì
     74     Γöé - ΓÉì
     75     Γöé - ┬╖┬╖return┬╖assistantMsg.content.map((block):┬╖MessagePart┬╖=>┬╖{ΓÉì
     76     Γöé - ┬╖┬╖┬╖┬╖if┬╖(block.type┬╖===┬╖"text")┬╖{ΓÉì
     77     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖{┬╖type:┬╖"text",┬╖text:┬╖block.text┬╖};ΓÉì
     78     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     79     Γöé - ┬╖┬╖┬╖┬╖if┬╖(block.type┬╖===┬╖"thinking")┬╖{ΓÉì
     80     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖{┬╖type:┬╖"thinking",┬╖thinking:┬╖block.thinking┬╖};ΓÉì
     81     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     82     Γöé - ┬╖┬╖┬╖┬╖const┬╖existing┬╖=┬╖existingToolCalls.get(block.id);ΓÉì
     83     Γöé - ┬╖┬╖┬╖┬╖return┬╖{ΓÉì
     84     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖type:┬╖"toolCall",ΓÉì
     85     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖id:┬╖block.id,ΓÉì
     86     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖name:┬╖block.name,ΓÉì
     87     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖args:┬╖block.arguments┬╖as┬╖Record<string,┬╖unknown>,ΓÉì
     88     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖status:┬╖existing?.type┬╖===┬╖"toolCall"┬╖?┬╖existing.status┬╖:┬╖"pending",ΓÉì
     89     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖result:┬╖existing?.type┬╖===┬╖"toolCall"┬╖?┬╖existing.result┬╖:┬╖undefined,ΓÉì
     90     Γöé - ┬╖┬╖┬╖┬╖};ΓÉì
     91     Γöé - ┬╖┬╖});ΓÉì
     92     Γöé - }ΓÉì
     93     Γöé - ΓÉì
     94     Γöé - export┬╖function┬╖agentMessagesToChatMessages(ΓÉì
     95     Γöé - ┬╖┬╖agentMessages:┬╖AgentMessage[],ΓÉì
     96     Γöé - ):┬╖ChatMessage[]┬╖{ΓÉì
     97     Γöé - ┬╖┬╖const┬╖result:┬╖ChatMessage[]┬╖=┬╖[];ΓÉì
     98     Γöé - ┬╖┬╖for┬╖(const┬╖msg┬╖of┬╖agentMessages)┬╖{ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖if┬╖(msg.role┬╖===┬╖"user")┬╖{ΓÉì
    100     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖text┬╖=┬╖stripEnrichment((msg┬╖as┬╖UserMessage).content);ΓÉì
    101     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖result.push({ΓÉì
    102     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖id:┬╖generateId(),ΓÉì
    103     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖role:┬╖"user",ΓÉì
    104     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖parts:┬╖[{┬╖type:┬╖"text",┬╖text┬╖}],ΓÉì
    105     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖timestamp:┬╖msg.timestamp,ΓÉì
    106     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖});ΓÉì
    107     Γöé - ┬╖┬╖┬╖┬╖}┬╖else┬╖if┬╖(msg.role┬╖===┬╖"assistant")┬╖{ΓÉì
    108     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖parts┬╖=┬╖extractPartsFromAssistantMessage(msg);ΓÉì
    109     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖result.push({ΓÉì
    110     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖id:┬╖generateId(),ΓÉì
    111     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖role:┬╖"assistant",ΓÉì
    112     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖parts,ΓÉì
    113     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖timestamp:┬╖msg.timestamp,ΓÉì
    114     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖});ΓÉì
    115     Γöé - ┬╖┬╖┬╖┬╖}┬╖else┬╖if┬╖(msg.role┬╖===┬╖"toolResult")┬╖{ΓÉì
    116     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖toolResult┬╖=┬╖msg┬╖as┬╖ToolResultMessage;ΓÉì
    117     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖for┬╖(let┬╖i┬╖=┬╖result.length┬╖-┬╖1;┬╖i┬╖>=┬╖0;┬╖i--)┬╖{ΓÉì
    118     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖chatMsg┬╖=┬╖result[i];ΓÉì
    119     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(chatMsg.role┬╖!==┬╖"assistant")┬╖continue;ΓÉì
    120     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖partIdx┬╖=┬╖chatMsg.parts.findIndex(ΓÉì
    121     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖(p)┬╖=>┬╖p.type┬╖===┬╖"toolCall"┬╖&&┬╖p.id┬╖===┬╖toolResult.toolCallId,ΓÉì
    122     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖);ΓÉì
    123     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(partIdx┬╖!==┬╖-1)┬╖{ΓÉì
    124     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖part┬╖=┬╖chatMsg.parts[partIdx];ΓÉì
    125     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(part.type┬╖===┬╖"toolCall")┬╖{ΓÉì
    126     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖resultText┬╖=┬╖toolResult.contentΓÉì
    127     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖.filter((c):┬╖c┬╖is┬╖TextContent┬╖=>┬╖c.type┬╖===┬╖"text")ΓÉì
    128     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖.map((c)┬╖=>┬╖c.text)ΓÉì
    129     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖.join("\n");ΓÉì
    130     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖chatMsg.parts[partIdx]┬╖=┬╖{ΓÉì
    131     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖...part,ΓÉì
    132     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖status:┬╖toolResult.isError┬╖?┬╖"error"┬╖:┬╖"complete",ΓÉì
    133     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖result:┬╖resultText,ΓÉì
    134     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
    135     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    136     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖break;ΓÉì
    137     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    138     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    139     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
    140     Γöé - ┬╖┬╖}ΓÉì
    141     Γöé - ┬╖┬╖return┬╖result;ΓÉì
    142     Γöé - }ΓÉì
    143     Γöé - ΓÉì
    144     Γöé - export┬╖function┬╖deriveStats(ΓÉì
    145     Γöé - ┬╖┬╖agentMessages:┬╖AgentMessage[],ΓÉì
    146     Γöé - ):┬╖Omit<SessionStats,┬╖"contextWindow">┬╖{ΓÉì
    147     Γöé - ┬╖┬╖let┬╖inputTokens┬╖=┬╖0;ΓÉì
    148     Γöé - ┬╖┬╖let┬╖outputTokens┬╖=┬╖0;ΓÉì
    149     Γöé - ┬╖┬╖let┬╖cacheRead┬╖=┬╖0;ΓÉì
    150     Γöé - ┬╖┬╖let┬╖cacheWrite┬╖=┬╖0;ΓÉì
  199 more lines truncated
  

src\lib\oauth\index.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - export┬╖interface┬╖OAuthCredentials┬╖{ΓÉì
      2     Γöé - ┬╖┬╖refresh:┬╖string;ΓÉì
      3     Γöé - ┬╖┬╖access:┬╖string;ΓÉì
      4     Γöé - ┬╖┬╖expires:┬╖number;ΓÉì
      5     Γöé - }ΓÉì
      6     Γöé - ΓÉì
      7     Γöé - export┬╖type┬╖OAuthFlowState┬╖=ΓÉì
      8     Γöé - ┬╖┬╖|┬╖{┬╖step:┬╖"idle"┬╖}ΓÉì
      9     Γöé - ┬╖┬╖|┬╖{┬╖step:┬╖"awaiting-code";┬╖verifier:┬╖string;┬╖oauthState?:┬╖string┬╖}ΓÉì
     10     Γöé - ┬╖┬╖|┬╖{┬╖step:┬╖"exchanging"┬╖}ΓÉì
     11     Γöé - ┬╖┬╖|┬╖{┬╖step:┬╖"connected"┬╖}ΓÉì
     12     Γöé - ┬╖┬╖|┬╖{┬╖step:┬╖"error";┬╖message:┬╖string┬╖};ΓÉì
     13     Γöé - ΓÉì
     14     Γöé - export┬╖const┬╖OAUTH_PROVIDERS:┬╖Record<ΓÉì
     15     Γöé - ┬╖┬╖string,ΓÉì
     16     Γöé - ┬╖┬╖{┬╖label:┬╖string;┬╖buttonText:┬╖string┬╖}ΓÉì
     17     Γöé - >┬╖=┬╖{ΓÉì
     18     Γöé - ┬╖┬╖anthropic:┬╖{ΓÉì
     19     Γöé - ┬╖┬╖┬╖┬╖label:┬╖"OAuth┬╖(Pro/Max)",ΓÉì
     20     Γöé - ┬╖┬╖┬╖┬╖buttonText:┬╖"Login┬╖with┬╖Claude┬╖Pro/Max",ΓÉì
     21     Γöé - ┬╖┬╖},ΓÉì
     22     Γöé - ┬╖┬╖"openai-codex":┬╖{ΓÉì
     23     Γöé - ┬╖┬╖┬╖┬╖label:┬╖"OAuth┬╖(Plus/Pro)",ΓÉì
     24     Γöé - ┬╖┬╖┬╖┬╖buttonText:┬╖"Login┬╖with┬╖ChatGPT┬╖Plus/Pro",ΓÉì
     25     Γöé - ┬╖┬╖},ΓÉì
     26     Γöé - };ΓÉì
     27     Γöé - ΓÉì
     28     Γöé - //┬╖---┬╖Credential┬╖Storage┬╖---ΓÉì
     29     Γöé - ΓÉì
     30     Γöé - const┬╖OAUTH_STORAGE_KEY┬╖=┬╖"openexcel-oauth-credentials";ΓÉì
     31     Γöé - ΓÉì
     32     Γöé - export┬╖function┬╖loadOAuthCredentials(ΓÉì
     33     Γöé - ┬╖┬╖provider:┬╖string,ΓÉì
     34     Γöé - ):┬╖OAuthCredentials┬╖|┬╖null┬╖{ΓÉì
     35     Γöé - ┬╖┬╖try┬╖{ΓÉì
     36     Γöé - ┬╖┬╖┬╖┬╖const┬╖store┬╖=┬╖JSON.parse(localStorage.getItem(OAUTH_STORAGE_KEY)┬╖||┬╖"{}");ΓÉì
     37     Γöé - ┬╖┬╖┬╖┬╖return┬╖store[provider]┬╖||┬╖null;ΓÉì
     38     Γöé - ┬╖┬╖}┬╖catch┬╖{ΓÉì
     39     Γöé - ┬╖┬╖┬╖┬╖return┬╖null;ΓÉì
     40     Γöé - ┬╖┬╖}ΓÉì
     41     Γöé - }ΓÉì
     42     Γöé - ΓÉì
     43     Γöé - export┬╖function┬╖saveOAuthCredentials(ΓÉì
     44     Γöé - ┬╖┬╖provider:┬╖string,ΓÉì
     45     Γöé - ┬╖┬╖creds:┬╖OAuthCredentials,ΓÉì
     46     Γöé - )┬╖{ΓÉì
     47     Γöé - ┬╖┬╖try┬╖{ΓÉì
     48     Γöé - ┬╖┬╖┬╖┬╖const┬╖store┬╖=┬╖JSON.parse(localStorage.getItem(OAUTH_STORAGE_KEY)┬╖||┬╖"{}");ΓÉì
     49     Γöé - ┬╖┬╖┬╖┬╖store[provider]┬╖=┬╖creds;ΓÉì
     50     Γöé - ┬╖┬╖┬╖┬╖localStorage.setItem(OAUTH_STORAGE_KEY,┬╖JSON.stringify(store));ΓÉì
     51     Γöé - ┬╖┬╖}┬╖catch┬╖{ΓÉì
     52     Γöé - ┬╖┬╖┬╖┬╖/*┬╖ignore┬╖*/ΓÉì
     53     Γöé - ┬╖┬╖}ΓÉì
     54     Γöé - }ΓÉì
     55     Γöé - ΓÉì
     56     Γöé - export┬╖function┬╖removeOAuthCredentials(provider:┬╖string)┬╖{ΓÉì
     57     Γöé - ┬╖┬╖try┬╖{ΓÉì
     58     Γöé - ┬╖┬╖┬╖┬╖const┬╖store┬╖=┬╖JSON.parse(localStorage.getItem(OAUTH_STORAGE_KEY)┬╖||┬╖"{}");ΓÉì
     59     Γöé - ┬╖┬╖┬╖┬╖delete┬╖store[provider];ΓÉì
     60     Γöé - ┬╖┬╖┬╖┬╖localStorage.setItem(OAUTH_STORAGE_KEY,┬╖JSON.stringify(store));ΓÉì
     61     Γöé - ┬╖┬╖}┬╖catch┬╖{ΓÉì
     62     Γöé - ┬╖┬╖┬╖┬╖/*┬╖ignore┬╖*/ΓÉì
     63     Γöé - ┬╖┬╖}ΓÉì
     64     Γöé - }ΓÉì
     65     Γöé - ΓÉì
     66     Γöé - //┬╖---┬╖PKCE┬╖(Web┬╖Crypto,┬╖browser-safe)┬╖---ΓÉì
     67     Γöé - ΓÉì
     68     Γöé - function┬╖base64urlEncode(bytes:┬╖Uint8Array):┬╖string┬╖{ΓÉì
     69     Γöé - ┬╖┬╖let┬╖binary┬╖=┬╖"";ΓÉì
     70     Γöé - ┬╖┬╖for┬╖(const┬╖byte┬╖of┬╖bytes)┬╖{ΓÉì
     71     Γöé - ┬╖┬╖┬╖┬╖binary┬╖+=┬╖String.fromCharCode(byte);ΓÉì
     72     Γöé - ┬╖┬╖}ΓÉì
     73     Γöé - ┬╖┬╖return┬╖btoa(binary).replace(/\+/g,┬╖"-").replace(/\//g,┬╖"_").replace(/=/g,┬╖"");ΓÉì
     74     Γöé - }ΓÉì
     75     Γöé - ΓÉì
     76     Γöé - export┬╖async┬╖function┬╖generatePKCE():┬╖Promise<{ΓÉì
     77     Γöé - ┬╖┬╖verifier:┬╖string;ΓÉì
     78     Γöé - ┬╖┬╖challenge:┬╖string;ΓÉì
     79     Γöé - }>┬╖{ΓÉì
     80     Γöé - ┬╖┬╖const┬╖verifierBytes┬╖=┬╖new┬╖Uint8Array(32);ΓÉì
     81     Γöé - ┬╖┬╖crypto.getRandomValues(verifierBytes);ΓÉì
     82     Γöé - ┬╖┬╖const┬╖verifier┬╖=┬╖base64urlEncode(verifierBytes);ΓÉì
     83     Γöé - ┬╖┬╖const┬╖data┬╖=┬╖new┬╖TextEncoder().encode(verifier);ΓÉì
     84     Γöé - ┬╖┬╖const┬╖hashBuffer┬╖=┬╖await┬╖crypto.subtle.digest("SHA-256",┬╖data);ΓÉì
     85     Γöé - ┬╖┬╖const┬╖challenge┬╖=┬╖base64urlEncode(new┬╖Uint8Array(hashBuffer));ΓÉì
     86     Γöé - ┬╖┬╖return┬╖{┬╖verifier,┬╖challenge┬╖};ΓÉì
     87     Γöé - }ΓÉì
     88     Γöé - ΓÉì
     89     Γöé - function┬╖createRandomState():┬╖string┬╖{ΓÉì
     90     Γöé - ┬╖┬╖const┬╖bytes┬╖=┬╖new┬╖Uint8Array(16);ΓÉì
     91     Γöé - ┬╖┬╖crypto.getRandomValues(bytes);ΓÉì
     92     Γöé - ┬╖┬╖return┬╖Array.from(bytes,┬╖(b)┬╖=>┬╖b.toString(16).padStart(2,┬╖"0")).join("");ΓÉì
     93     Γöé - }ΓÉì
     94     Γöé - ΓÉì
     95     Γöé - //┬╖---┬╖Provider┬╖Constants┬╖---ΓÉì
     96     Γöé - ΓÉì
     97     Γöé - const┬╖ANTHROPIC_CLIENT_ID┬╖=┬╖atob(ΓÉì
     98     Γöé - ┬╖┬╖"OWQxYzI1MGEtZTYxYi00NGQ5LTg4ZWQtNTk0NGQxOTYyZjVl",ΓÉì
     99     Γöé - );ΓÉì
    100     Γöé - const┬╖ANTHROPIC_AUTHORIZE_URL┬╖=┬╖"https://claude.ai/oauth/authorize";ΓÉì
    101     Γöé - const┬╖ANTHROPIC_TOKEN_URL┬╖=┬╖"https://console.anthropic.com/v1/oauth/token";ΓÉì
    102     Γöé - const┬╖ANTHROPIC_REDIRECT_URI┬╖=ΓÉì
    103     Γöé - ┬╖┬╖"https://console.anthropic.com/oauth/code/callback";ΓÉì
    104     Γöé - const┬╖ANTHROPIC_SCOPES┬╖=┬╖"org:create_api_key┬╖user:profile┬╖user:inference";ΓÉì
    105     Γöé - ΓÉì
    106     Γöé - const┬╖OPENAI_CODEX_CLIENT_ID┬╖=┬╖atob("YXBwX0VNb2FtRUVaNzNmMENrWGFYcDdocmFubg==");ΓÉì
    107     Γöé - const┬╖OPENAI_CODEX_AUTHORIZE_URL┬╖=┬╖"https://auth.openai.com/oauth/authorize";ΓÉì
    108     Γöé - const┬╖OPENAI_CODEX_TOKEN_URL┬╖=┬╖"https://auth.openai.com/oauth/token";ΓÉì
    109     Γöé - const┬╖OPENAI_CODEX_REDIRECT_URI┬╖=┬╖"http://localhost:1455/auth/callback";ΓÉì
    110     Γöé - const┬╖OPENAI_CODEX_SCOPE┬╖=┬╖"openid┬╖profile┬╖email┬╖offline_access";ΓÉì
    111     Γöé - ΓÉì
    112     Γöé - //┬╖---┬╖Authorization┬╖URL┬╖---ΓÉì
    113     Γöé - ΓÉì
    114     Γöé - export┬╖function┬╖buildAuthorizationUrl(ΓÉì
    115     Γöé - ┬╖┬╖provider:┬╖string,ΓÉì
    116     Γöé - ┬╖┬╖challenge:┬╖string,ΓÉì
    117     Γöé - ┬╖┬╖verifier:┬╖string,ΓÉì
    118     Γöé - ):┬╖{┬╖url:┬╖string;┬╖oauthState?:┬╖string┬╖}┬╖{ΓÉì
    119     Γöé - ┬╖┬╖if┬╖(provider┬╖===┬╖"openai-codex")┬╖{ΓÉì
    120     Γöé - ┬╖┬╖┬╖┬╖const┬╖oauthState┬╖=┬╖createRandomState();ΓÉì
    121     Γöé - ┬╖┬╖┬╖┬╖const┬╖params┬╖=┬╖new┬╖URLSearchParams({ΓÉì
    122     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖response_type:┬╖"code",ΓÉì
    123     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖client_id:┬╖OPENAI_CODEX_CLIENT_ID,ΓÉì
    124     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖redirect_uri:┬╖OPENAI_CODEX_REDIRECT_URI,ΓÉì
    125     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖scope:┬╖OPENAI_CODEX_SCOPE,ΓÉì
    126     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖code_challenge:┬╖challenge,ΓÉì
    127     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖code_challenge_method:┬╖"S256",ΓÉì
    128     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖state:┬╖oauthState,ΓÉì
    129     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖id_token_add_organizations:┬╖"true",ΓÉì
    130     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖codex_cli_simplified_flow:┬╖"true",ΓÉì
    131     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖originator:┬╖"pi",ΓÉì
    132     Γöé - ┬╖┬╖┬╖┬╖});ΓÉì
    133     Γöé - ┬╖┬╖┬╖┬╖return┬╖{┬╖url:┬╖`${OPENAI_CODEX_AUTHORIZE_URL}?${params}`,┬╖oauthState┬╖};ΓÉì
    134     Γöé - ┬╖┬╖}ΓÉì
    135     Γöé - ┬╖┬╖const┬╖params┬╖=┬╖new┬╖URLSearchParams({ΓÉì
    136     Γöé - ┬╖┬╖┬╖┬╖code:┬╖"true",ΓÉì
    137     Γöé - ┬╖┬╖┬╖┬╖client_id:┬╖ANTHROPIC_CLIENT_ID,ΓÉì
    138     Γöé - ┬╖┬╖┬╖┬╖response_type:┬╖"code",ΓÉì
    139     Γöé - ┬╖┬╖┬╖┬╖redirect_uri:┬╖ANTHROPIC_REDIRECT_URI,ΓÉì
    140     Γöé - ┬╖┬╖┬╖┬╖scope:┬╖ANTHROPIC_SCOPES,ΓÉì
    141     Γöé - ┬╖┬╖┬╖┬╖code_challenge:┬╖challenge,ΓÉì
    142     Γöé - ┬╖┬╖┬╖┬╖code_challenge_method:┬╖"S256",ΓÉì
    143     Γöé - ┬╖┬╖┬╖┬╖state:┬╖verifier,ΓÉì
    144     Γöé - ┬╖┬╖});ΓÉì
    145     Γöé - ┬╖┬╖return┬╖{┬╖url:┬╖`${ANTHROPIC_AUTHORIZE_URL}?${params}`┬╖};ΓÉì
    146     Γöé - }ΓÉì
    147     Γöé - ΓÉì
    148     Γöé - //┬╖---┬╖Input┬╖Parsing┬╖---ΓÉì
    149     Γöé - ΓÉì
    150     Γöé - function┬╖parseAuthorizationInput(input:┬╖string):┬╖{ΓÉì
  557 more lines truncated
  

src\lib\openrouter-models.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      3   3 Γöé   export const OPENROUTER_FREE_MODELS: Model<any>[] = [
      4   4 Γöé     {
      5     Γöé - ┬╖┬╖┬╖┬╖"id":┬╖"openrouter/aurora-alpha",
      6     Γöé - ┬╖┬╖┬╖┬╖"name":┬╖"Aurora┬╖Alpha",
      7     Γöé - ┬╖┬╖┬╖┬╖"api":┬╖"openai-completions",
      8     Γöé - ┬╖┬╖┬╖┬╖"provider":┬╖"openrouter",
      9     Γöé - ┬╖┬╖┬╖┬╖"reasoning":┬╖true,
     10     Γöé - ┬╖┬╖┬╖┬╖"input":┬╖[
     11     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"text"
     12     Γöé - ┬╖┬╖┬╖┬╖],
     13     Γöé - ┬╖┬╖┬╖┬╖"cost":┬╖{
     14     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"input":┬╖0,
     15     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"output":┬╖0,
     16     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheRead":┬╖0,
     17     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheWrite":┬╖0
          5 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"openrouter/aurora-alpha",
          6 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"Aurora┬╖Alpha",
          7 Γöé + ┬╖┬╖┬╖┬╖api:┬╖"openai-completions",
          8 Γöé + ┬╖┬╖┬╖┬╖provider:┬╖"openrouter",
          9 Γöé + ┬╖┬╖┬╖┬╖reasoning:┬╖true,
         10 Γöé + ┬╖┬╖┬╖┬╖input:┬╖["text"],
         11 Γöé + ┬╖┬╖┬╖┬╖cost:┬╖{
         12 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖input:┬╖0,
         13 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖output:┬╖0,
         14 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheRead:┬╖0,
         15 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheWrite:┬╖0,
     18  16 Γöé       },
     19     Γöé - ┬╖┬╖┬╖┬╖"contextWindow":┬╖128000,
     20     Γöé - ┬╖┬╖┬╖┬╖"maxTokens":┬╖50000
         17 Γöé + ┬╖┬╖┬╖┬╖contextWindow:┬╖128000,
         18 Γöé + ┬╖┬╖┬╖┬╖maxTokens:┬╖50000,
     21  19 Γöé     },
     22  20 Γöé     {
     23     Γöé - ┬╖┬╖┬╖┬╖"id":┬╖"openrouter/pony-alpha",
     24     Γöé - ┬╖┬╖┬╖┬╖"name":┬╖"Pony┬╖Alpha",
     25     Γöé - ┬╖┬╖┬╖┬╖"api":┬╖"openai-completions",
     26     Γöé - ┬╖┬╖┬╖┬╖"provider":┬╖"openrouter",
     27     Γöé - ┬╖┬╖┬╖┬╖"reasoning":┬╖true,
     28     Γöé - ┬╖┬╖┬╖┬╖"input":┬╖[
     29     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"text"
     30     Γöé - ┬╖┬╖┬╖┬╖],
     31     Γöé - ┬╖┬╖┬╖┬╖"cost":┬╖{
     32     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"input":┬╖0,
     33     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"output":┬╖0,
     34     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheRead":┬╖0,
     35     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheWrite":┬╖0
         21 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"openrouter/pony-alpha",
         22 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"Pony┬╖Alpha",
         23 Γöé + ┬╖┬╖┬╖┬╖api:┬╖"openai-completions",
         24 Γöé + ┬╖┬╖┬╖┬╖provider:┬╖"openrouter",
         25 Γöé + ┬╖┬╖┬╖┬╖reasoning:┬╖true,
         26 Γöé + ┬╖┬╖┬╖┬╖input:┬╖["text"],
         27 Γöé + ┬╖┬╖┬╖┬╖cost:┬╖{
         28 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖input:┬╖0,
         29 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖output:┬╖0,
         30 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheRead:┬╖0,
         31 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheWrite:┬╖0,
     36  32 Γöé       },
     37     Γöé - ┬╖┬╖┬╖┬╖"contextWindow":┬╖200000,
     38     Γöé - ┬╖┬╖┬╖┬╖"maxTokens":┬╖131000
         33 Γöé + ┬╖┬╖┬╖┬╖contextWindow:┬╖200000,
         34 Γöé + ┬╖┬╖┬╖┬╖maxTokens:┬╖131000,
     39  35 Γöé     },
     40  36 Γöé     {
     41     Γöé - ┬╖┬╖┬╖┬╖"id":┬╖"openrouter/free",
     42     Γöé - ┬╖┬╖┬╖┬╖"name":┬╖"Free┬╖Models┬╖Router",
     43     Γöé - ┬╖┬╖┬╖┬╖"api":┬╖"openai-completions",
     44     Γöé - ┬╖┬╖┬╖┬╖"provider":┬╖"openrouter",
     45     Γöé - ┬╖┬╖┬╖┬╖"reasoning":┬╖true,
     46     Γöé - ┬╖┬╖┬╖┬╖"input":┬╖[
     47     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"text",
     48     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"image"
     49     Γöé - ┬╖┬╖┬╖┬╖],
     50     Γöé - ┬╖┬╖┬╖┬╖"cost":┬╖{
     51     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"input":┬╖0,
     52     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"output":┬╖0,
     53     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheRead":┬╖0,
     54     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheWrite":┬╖0
         37 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"openrouter/free",
         38 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"Free┬╖Models┬╖Router",
         39 Γöé + ┬╖┬╖┬╖┬╖api:┬╖"openai-completions",
         40 Γöé + ┬╖┬╖┬╖┬╖provider:┬╖"openrouter",
         41 Γöé + ┬╖┬╖┬╖┬╖reasoning:┬╖true,
         42 Γöé + ┬╖┬╖┬╖┬╖input:┬╖["text",┬╖"image"],
         43 Γöé + ┬╖┬╖┬╖┬╖cost:┬╖{
         44 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖input:┬╖0,
         45 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖output:┬╖0,
         46 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheRead:┬╖0,
         47 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheWrite:┬╖0,
     55  48 Γöé       },
     56     Γöé - ┬╖┬╖┬╖┬╖"contextWindow":┬╖200000,
     57     Γöé - ┬╖┬╖┬╖┬╖"maxTokens":┬╖32000
         49 Γöé + ┬╖┬╖┬╖┬╖contextWindow:┬╖200000,
         50 Γöé + ┬╖┬╖┬╖┬╖maxTokens:┬╖32000,
     58  51 Γöé     },
     59  52 Γöé     {
     60     Γöé - ┬╖┬╖┬╖┬╖"id":┬╖"stepfun/step-3.5-flash:free",
     61     Γöé - ┬╖┬╖┬╖┬╖"name":┬╖"StepFun:┬╖Step┬╖3.5┬╖Flash┬╖(free)",
     62     Γöé - ┬╖┬╖┬╖┬╖"api":┬╖"openai-completions",
     63     Γöé - ┬╖┬╖┬╖┬╖"provider":┬╖"openrouter",
     64     Γöé - ┬╖┬╖┬╖┬╖"reasoning":┬╖true,
     65     Γöé - ┬╖┬╖┬╖┬╖"input":┬╖[
     66     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"text"
     67     Γöé - ┬╖┬╖┬╖┬╖],
     68     Γöé - ┬╖┬╖┬╖┬╖"cost":┬╖{
     69     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"input":┬╖0,
     70     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"output":┬╖0,
     71     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheRead":┬╖0,
     72     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheWrite":┬╖0
         53 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"stepfun/step-3.5-flash:free",
         54 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"StepFun:┬╖Step┬╖3.5┬╖Flash┬╖(free)",
         55 Γöé + ┬╖┬╖┬╖┬╖api:┬╖"openai-completions",
         56 Γöé + ┬╖┬╖┬╖┬╖provider:┬╖"openrouter",
         57 Γöé + ┬╖┬╖┬╖┬╖reasoning:┬╖true,
         58 Γöé + ┬╖┬╖┬╖┬╖input:┬╖["text"],
         59 Γöé + ┬╖┬╖┬╖┬╖cost:┬╖{
         60 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖input:┬╖0,
         61 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖output:┬╖0,
         62 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheRead:┬╖0,
         63 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheWrite:┬╖0,
     73  64 Γöé       },
     74     Γöé - ┬╖┬╖┬╖┬╖"contextWindow":┬╖256000,
     75     Γöé - ┬╖┬╖┬╖┬╖"maxTokens":┬╖256000
         65 Γöé + ┬╖┬╖┬╖┬╖contextWindow:┬╖256000,
         66 Γöé + ┬╖┬╖┬╖┬╖maxTokens:┬╖256000,
     76  67 Γöé     },
     77  68 Γöé     {
     78     Γöé - ┬╖┬╖┬╖┬╖"id":┬╖"arcee-ai/trinity-large-preview:free",
     79     Γöé - ┬╖┬╖┬╖┬╖"name":┬╖"Arcee┬╖AI:┬╖Trinity┬╖Large┬╖Preview┬╖(free)",
     80     Γöé - ┬╖┬╖┬╖┬╖"api":┬╖"openai-completions",
     81     Γöé - ┬╖┬╖┬╖┬╖"provider":┬╖"openrouter",
     82     Γöé - ┬╖┬╖┬╖┬╖"reasoning":┬╖true,
     83     Γöé - ┬╖┬╖┬╖┬╖"input":┬╖[
     84     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"text"
     85     Γöé - ┬╖┬╖┬╖┬╖],
     86     Γöé - ┬╖┬╖┬╖┬╖"cost":┬╖{
     87     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"input":┬╖0,
     88     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"output":┬╖0,
     89     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheRead":┬╖0,
     90     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"cacheWrite":┬╖0
         69 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"arcee-ai/trinity-large-preview:free",
         70 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"Arcee┬╖AI:┬╖Trinity┬╖Large┬╖Preview┬╖(free)",
         71 Γöé + ┬╖┬╖┬╖┬╖api:┬╖"openai-completions",
         72 Γöé + ┬╖┬╖┬╖┬╖provider:┬╖"openrouter",
         73 Γöé + ┬╖┬╖┬╖┬╖reasoning:┬╖true,
         74 Γöé + ┬╖┬╖┬╖┬╖input:┬╖["text"],
         75 Γöé + ┬╖┬╖┬╖┬╖cost:┬╖{
         76 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖input:┬╖0,
         77 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖output:┬╖0,
         78 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖cacheRead:┬╖0,
  852 more lines truncated
  

src\lib\provider-config.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - import┬╖type┬╖{┬╖Api,┬╖Model┬╖}┬╖from┬╖"@mariozechner/pi-ai";ΓÉì
      2     Γöé - import┬╖{┬╖loadOAuthCredentials┬╖}┬╖from┬╖"./oauth";ΓÉì
      3     Γöé - ΓÉì
      4     Γöé - export┬╖type┬╖ThinkingLevel┬╖=┬╖"none"┬╖|┬╖"low"┬╖|┬╖"medium"┬╖|┬╖"high";ΓÉì
      5     Γöé - ΓÉì
      6     Γöé - export┬╖interface┬╖ProviderConfig┬╖{ΓÉì
      7     Γöé - ┬╖┬╖provider:┬╖string;ΓÉì
      8     Γöé - ┬╖┬╖apiKey:┬╖string;ΓÉì
      9     Γöé - ┬╖┬╖model:┬╖string;ΓÉì
     10     Γöé - ┬╖┬╖useProxy:┬╖boolean;ΓÉì
     11     Γöé - ┬╖┬╖proxyUrl:┬╖string;ΓÉì
     12     Γöé - ┬╖┬╖thinking:┬╖ThinkingLevel;ΓÉì
     13     Γöé - ┬╖┬╖followMode:┬╖boolean;ΓÉì
     14     Γöé - ┬╖┬╖apiType?:┬╖string;ΓÉì
     15     Γöé - ┬╖┬╖customBaseUrl?:┬╖string;ΓÉì
     16     Γöé - ┬╖┬╖authMethod?:┬╖"apikey"┬╖|┬╖"oauth";ΓÉì
     17     Γöé - }ΓÉì
     18     Γöé - ΓÉì
     19     Γöé - const┬╖STORAGE_KEY┬╖=┬╖"openexcel-provider-config";ΓÉì
     20     Γöé - ΓÉì
     21     Γöé - export┬╖const┬╖THINKING_LEVELS:┬╖{┬╖value:┬╖ThinkingLevel;┬╖label:┬╖string┬╖}[]┬╖=┬╖[ΓÉì
     22     Γöé - ┬╖┬╖{┬╖value:┬╖"none",┬╖label:┬╖"None"┬╖},ΓÉì
     23     Γöé - ┬╖┬╖{┬╖value:┬╖"low",┬╖label:┬╖"Low"┬╖},ΓÉì
     24     Γöé - ┬╖┬╖{┬╖value:┬╖"medium",┬╖label:┬╖"Medium"┬╖},ΓÉì
     25     Γöé - ┬╖┬╖{┬╖value:┬╖"high",┬╖label:┬╖"High"┬╖},ΓÉì
     26     Γöé - ];ΓÉì
     27     Γöé - ΓÉì
     28     Γöé - export┬╖const┬╖API_TYPES┬╖=┬╖[ΓÉì
     29     Γöé - ┬╖┬╖{ΓÉì
     30     Γöé - ┬╖┬╖┬╖┬╖id:┬╖"openai-completions",ΓÉì
     31     Γöé - ┬╖┬╖┬╖┬╖name:┬╖"OpenAI┬╖Completions",ΓÉì
     32     Γöé - ┬╖┬╖┬╖┬╖hint:┬╖"Most┬╖compatible┬╖ΓÇö┬╖Ollama,┬╖vLLM,┬╖LMStudio,┬╖etc.",ΓÉì
     33     Γöé - ┬╖┬╖},ΓÉì
     34     Γöé - ┬╖┬╖{ΓÉì
     35     Γöé - ┬╖┬╖┬╖┬╖id:┬╖"openai-responses",ΓÉì
     36     Γöé - ┬╖┬╖┬╖┬╖name:┬╖"OpenAI┬╖Responses",ΓÉì
     37     Γöé - ┬╖┬╖┬╖┬╖hint:┬╖"Newer┬╖OpenAI┬╖API┬╖format",ΓÉì
     38     Γöé - ┬╖┬╖},ΓÉì
     39     Γöé - ┬╖┬╖{┬╖id:┬╖"anthropic-messages",┬╖name:┬╖"Anthropic┬╖Messages",┬╖hint:┬╖"Claude┬╖API"┬╖},ΓÉì
     40     Γöé - ┬╖┬╖{ΓÉì
     41     Γöé - ┬╖┬╖┬╖┬╖id:┬╖"google-generative-ai",ΓÉì
     42     Γöé - ┬╖┬╖┬╖┬╖name:┬╖"Google┬╖Generative┬╖AI",ΓÉì
     43     Γöé - ┬╖┬╖┬╖┬╖hint:┬╖"Gemini┬╖API",ΓÉì
     44     Γöé - ┬╖┬╖},ΓÉì
     45     Γöé - ┬╖┬╖{ΓÉì
     46     Γöé - ┬╖┬╖┬╖┬╖id:┬╖"azure-openai-responses",ΓÉì
     47     Γöé - ┬╖┬╖┬╖┬╖name:┬╖"Azure┬╖OpenAI┬╖Responses",ΓÉì
     48     Γöé - ┬╖┬╖┬╖┬╖hint:┬╖"Azure-hosted┬╖OpenAI",ΓÉì
     49     Γöé - ┬╖┬╖},ΓÉì
     50     Γöé - ┬╖┬╖{ΓÉì
     51     Γöé - ┬╖┬╖┬╖┬╖id:┬╖"openai-codex-responses",ΓÉì
     52     Γöé - ┬╖┬╖┬╖┬╖name:┬╖"OpenAI┬╖Codex┬╖Responses",ΓÉì
     53     Γöé - ┬╖┬╖┬╖┬╖hint:┬╖"ChatGPT┬╖subscription┬╖models",ΓÉì
     54     Γöé - ┬╖┬╖},ΓÉì
     55     Γöé - ┬╖┬╖{ΓÉì
     56     Γöé - ┬╖┬╖┬╖┬╖id:┬╖"google-gemini-cli",ΓÉì
     57     Γöé - ┬╖┬╖┬╖┬╖name:┬╖"Google┬╖Gemini┬╖CLI",ΓÉì
     58     Γöé - ┬╖┬╖┬╖┬╖hint:┬╖"Cloud┬╖Code┬╖Assist",ΓÉì
     59     Γöé - ┬╖┬╖},ΓÉì
     60     Γöé - ┬╖┬╖{┬╖id:┬╖"google-vertex",┬╖name:┬╖"Google┬╖Vertex┬╖AI",┬╖hint:┬╖"Vertex┬╖AI┬╖endpoint"┬╖},ΓÉì
     61     Γöé - ];ΓÉì
     62     Γöé - ΓÉì
     63     Γöé - export┬╖function┬╖loadSavedConfig():┬╖ProviderConfig┬╖|┬╖null┬╖{ΓÉì
     64     Γöé - ┬╖┬╖try┬╖{ΓÉì
     65     Γöé - ┬╖┬╖┬╖┬╖const┬╖saved┬╖=┬╖localStorage.getItem(STORAGE_KEY);ΓÉì
     66     Γöé - ┬╖┬╖┬╖┬╖if┬╖(saved)┬╖{ΓÉì
     67     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖config┬╖=┬╖JSON.parse(saved);ΓÉì
     68     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(config.proxyUrl┬╖===┬╖undefined)┬╖config.proxyUrl┬╖=┬╖"";ΓÉì
     69     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(config.followMode┬╖===┬╖undefined)┬╖config.followMode┬╖=┬╖true;ΓÉì
     70     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(config.apiType┬╖===┬╖undefined)┬╖config.apiType┬╖=┬╖"";ΓÉì
     71     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(config.customBaseUrl┬╖===┬╖undefined)┬╖config.customBaseUrl┬╖=┬╖"";ΓÉì
     72     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(config.authMethod┬╖===┬╖undefined)┬╖config.authMethod┬╖=┬╖"apikey";ΓÉì
     73     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(config.authMethod┬╖===┬╖"oauth")┬╖{ΓÉì
     74     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖creds┬╖=┬╖loadOAuthCredentials(config.provider);ΓÉì
     75     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(creds)┬╖config.apiKey┬╖=┬╖creds.access;ΓÉì
     76     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     77     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖config;ΓÉì
     78     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     79     Γöé - ┬╖┬╖}┬╖catch┬╖{}ΓÉì
     80     Γöé - ┬╖┬╖return┬╖null;ΓÉì
     81     Γöé - }ΓÉì
     82     Γöé - ΓÉì
     83     Γöé - export┬╖function┬╖saveConfig(config:┬╖ProviderConfig)┬╖{ΓÉì
     84     Γöé - ┬╖┬╖localStorage.setItem(STORAGE_KEY,┬╖JSON.stringify(config));ΓÉì
     85     Γöé - }ΓÉì
     86     Γöé - ΓÉì
     87     Γöé - export┬╖function┬╖buildCustomModel(config:┬╖ProviderConfig):┬╖Model<any>┬╖|┬╖null┬╖{ΓÉì
     88     Γöé - ┬╖┬╖if┬╖(!config.apiType┬╖||┬╖!config.customBaseUrl┬╖||┬╖!config.model)┬╖return┬╖null;ΓÉì
     89     Γöé - ┬╖┬╖return┬╖{ΓÉì
     90     Γöé - ┬╖┬╖┬╖┬╖id:┬╖config.model,ΓÉì
     91     Γöé - ┬╖┬╖┬╖┬╖name:┬╖config.model,ΓÉì
     92     Γöé - ┬╖┬╖┬╖┬╖api:┬╖config.apiType┬╖as┬╖Api,ΓÉì
     93     Γöé - ┬╖┬╖┬╖┬╖provider:┬╖"custom"┬╖as┬╖any,ΓÉì
     94     Γöé - ┬╖┬╖┬╖┬╖baseUrl:┬╖config.customBaseUrl,ΓÉì
     95     Γöé - ┬╖┬╖┬╖┬╖reasoning:┬╖true,ΓÉì
     96     Γöé - ┬╖┬╖┬╖┬╖input:┬╖["text",┬╖"image"]┬╖as┬╖("text"┬╖|┬╖"image")[],ΓÉì
     97     Γöé - ┬╖┬╖┬╖┬╖cost:┬╖{┬╖input:┬╖0,┬╖output:┬╖0,┬╖cacheRead:┬╖0,┬╖cacheWrite:┬╖0┬╖},ΓÉì
     98     Γöé - ┬╖┬╖┬╖┬╖contextWindow:┬╖128000,ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖maxTokens:┬╖32000,ΓÉì
    100     Γöé - ┬╖┬╖};ΓÉì
    101     Γöé - }ΓÉì
    102     Γöé - ΓÉì
    103     Γöé - export┬╖function┬╖applyProxyToModel(ΓÉì
    104     Γöé - ┬╖┬╖model:┬╖Model<any>,ΓÉì
    105     Γöé - ┬╖┬╖config:┬╖ProviderConfig,ΓÉì
    106     Γöé - ):┬╖Model<any>┬╖{ΓÉì
    107     Γöé - ┬╖┬╖if┬╖(!config.useProxy┬╖||┬╖!config.proxyUrl┬╖||┬╖!model.baseUrl)┬╖return┬╖model;ΓÉì
    108     Γöé - ┬╖┬╖return┬╖{ΓÉì
    109     Γöé - ┬╖┬╖┬╖┬╖...model,ΓÉì
    110     Γöé - ┬╖┬╖┬╖┬╖baseUrl:┬╖`${config.proxyUrl}/?url=${encodeURIComponent(model.baseUrl)}`,ΓÉì
    111     Γöé - ┬╖┬╖};ΓÉì
    112     Γöé - }ΓÉì
          1 Γöé + import┬╖type┬╖{┬╖Api,┬╖Model┬╖}┬╖from┬╖"@mariozechner/pi-ai";
          2 Γöé + import┬╖{┬╖loadOAuthCredentials┬╖}┬╖from┬╖"./oauth";
          3 Γöé + 
          4 Γöé + export┬╖type┬╖ThinkingLevel┬╖=┬╖"none"┬╖|┬╖"low"┬╖|┬╖"medium"┬╖|┬╖"high";
          5 Γöé + 
          6 Γöé + export┬╖interface┬╖ProviderConfig┬╖{
          7 Γöé + ┬╖┬╖provider:┬╖string;
          8 Γöé + ┬╖┬╖apiKey:┬╖string;
          9 Γöé + ┬╖┬╖model:┬╖string;
         10 Γöé + ┬╖┬╖useProxy:┬╖boolean;
         11 Γöé + ┬╖┬╖proxyUrl:┬╖string;
         12 Γöé + ┬╖┬╖thinking:┬╖ThinkingLevel;
         13 Γöé + ┬╖┬╖followMode:┬╖boolean;
         14 Γöé + ┬╖┬╖apiType?:┬╖string;
         15 Γöé + ┬╖┬╖customBaseUrl?:┬╖string;
         16 Γöé + ┬╖┬╖authMethod?:┬╖"apikey"┬╖|┬╖"oauth";
         17 Γöé + }
         18 Γöé + 
         19 Γöé + const┬╖STORAGE_KEY┬╖=┬╖"openexcel-provider-config";
         20 Γöé + 
         21 Γöé + export┬╖const┬╖THINKING_LEVELS:┬╖{┬╖value:┬╖ThinkingLevel;┬╖label:┬╖string┬╖}[]┬╖=┬╖[
         22 Γöé + ┬╖┬╖{┬╖value:┬╖"none",┬╖label:┬╖"None"┬╖},
         23 Γöé + ┬╖┬╖{┬╖value:┬╖"low",┬╖label:┬╖"Low"┬╖},
         24 Γöé + ┬╖┬╖{┬╖value:┬╖"medium",┬╖label:┬╖"Medium"┬╖},
         25 Γöé + ┬╖┬╖{┬╖value:┬╖"high",┬╖label:┬╖"High"┬╖},
         26 Γöé + ];
         27 Γöé + 
         28 Γöé + export┬╖const┬╖API_TYPES┬╖=┬╖[
         29 Γöé + ┬╖┬╖{
         30 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"openai-completions",
         31 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"OpenAI┬╖Completions",
         32 Γöé + ┬╖┬╖┬╖┬╖hint:┬╖"Most┬╖compatible┬╖ΓÇö┬╖Ollama,┬╖vLLM,┬╖LMStudio,┬╖etc.",
         33 Γöé + ┬╖┬╖},
         34 Γöé + ┬╖┬╖{
         35 Γöé + ┬╖┬╖┬╖┬╖id:┬╖"openai-responses",
         36 Γöé + ┬╖┬╖┬╖┬╖name:┬╖"OpenAI┬╖Responses",
         37 Γöé + ┬╖┬╖┬╖┬╖hint:┬╖"Newer┬╖OpenAI┬╖API┬╖format",
         38 Γöé + ┬╖┬╖},
  75 more lines truncated
  

src\lib\sandbox.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - import┬╖{┬╖ensureLockdown┬╖}┬╖from┬╖"../taskpane/lockdown";ΓÉì
     2    Γöé - ΓÉì
     3    Γöé - /*┬╖global┬╖Compartment┬╖*/ΓÉì
     4    Γöé - ΓÉì
     5    Γöé - export┬╖function┬╖sandboxedEval(ΓÉì
     6    Γöé - ┬╖┬╖code:┬╖string,ΓÉì
     7    Γöé - ┬╖┬╖globals:┬╖Record<string,┬╖unknown>,ΓÉì
     8    Γöé - ):┬╖unknown┬╖{ΓÉì
     9    Γöé - ┬╖┬╖ensureLockdown();ΓÉì
    10    Γöé - ┬╖┬╖const┬╖compartment┬╖=┬╖new┬╖Compartment({ΓÉì
    11    Γöé - ┬╖┬╖┬╖┬╖globals:┬╖{ΓÉì
    12    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖...globals,ΓÉì
    13    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖console,ΓÉì
    14    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Math,ΓÉì
    15    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Date,ΓÉì
    16    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Function:┬╖undefined,ΓÉì
    17    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Reflect:┬╖undefined,ΓÉì
    18    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Proxy:┬╖undefined,ΓÉì
    19    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Compartment:┬╖undefined,ΓÉì
    20    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖harden:┬╖undefined,ΓÉì
    21    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖lockdown:┬╖undefined,ΓÉì
    22    Γöé - ┬╖┬╖┬╖┬╖},ΓÉì
    23    Γöé - ┬╖┬╖┬╖┬╖__options__:┬╖true,ΓÉì
    24    Γöé - ┬╖┬╖});ΓÉì
    25    Γöé - ┬╖┬╖return┬╖compartment.evaluate(`(async┬╖()┬╖=>┬╖{┬╖${code}┬╖})()`);ΓÉì
    26    Γöé - }ΓÉì
        1 Γöé + import┬╖{┬╖ensureLockdown┬╖}┬╖from┬╖"../taskpane/lockdown";
        2 Γöé + 
        3 Γöé + /*┬╖global┬╖Compartment┬╖*/
        4 Γöé + 
        5 Γöé + export┬╖function┬╖sandboxedEval(
        6 Γöé + ┬╖┬╖code:┬╖string,
        7 Γöé + ┬╖┬╖globals:┬╖Record<string,┬╖unknown>,
        8 Γöé + ):┬╖unknown┬╖{
        9 Γöé + ┬╖┬╖ensureLockdown();
       10 Γöé + ┬╖┬╖const┬╖compartment┬╖=┬╖new┬╖Compartment({
       11 Γöé + ┬╖┬╖┬╖┬╖globals:┬╖{
       12 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖...globals,
       13 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖console,
       14 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Math,
       15 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Date,
       16 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Function:┬╖undefined,
       17 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Reflect:┬╖undefined,
       18 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Proxy:┬╖undefined,
       19 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Compartment:┬╖undefined,
       20 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖harden:┬╖undefined,
       21 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖lockdown:┬╖undefined,
       22 Γöé + ┬╖┬╖┬╖┬╖},
       23 Γöé + ┬╖┬╖┬╖┬╖__options__:┬╖true,
       24 Γöé + ┬╖┬╖});
       25 Γöé + ┬╖┬╖return┬╖compartment.evaluate(`(async┬╖()┬╖=>┬╖{┬╖${code}┬╖})()`);
       26 Γöé + }
    27 27 Γöé   
  

src\lib\skills\index.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - import┬╖{ΓÉì
      2     Γöé - ┬╖┬╖deleteSkillFiles,ΓÉì
      3     Γöé - ┬╖┬╖listSkillNames,ΓÉì
      4     Γöé - ┬╖┬╖loadAllSkillFiles,ΓÉì
      5     Γöé - ┬╖┬╖loadSkillFiles,ΓÉì
      6     Γöé - ┬╖┬╖saveSkillFiles,ΓÉì
      7     Γöé - }┬╖from┬╖"../storage";ΓÉì
      8     Γöé - import┬╖{┬╖setSkillFiles┬╖}┬╖from┬╖"../vfs";ΓÉì
      9     Γöé - ΓÉì
     10     Γöé - const┬╖encoder┬╖=┬╖new┬╖TextEncoder();ΓÉì
     11     Γöé - const┬╖decoder┬╖=┬╖new┬╖TextDecoder();ΓÉì
     12     Γöé - ΓÉì
     13     Γöé - export┬╖interface┬╖SkillMeta┬╖{ΓÉì
     14     Γöé - ┬╖┬╖name:┬╖string;ΓÉì
     15     Γöé - ┬╖┬╖description:┬╖string;ΓÉì
     16     Γöé - ┬╖┬╖platform?:┬╖string;ΓÉì
     17     Γöé - }ΓÉì
     18     Γöé - ΓÉì
     19     Γöé - export┬╖interface┬╖SkillInput┬╖{ΓÉì
     20     Γöé - ┬╖┬╖path:┬╖string;ΓÉì
     21     Γöé - ┬╖┬╖data:┬╖string┬╖|┬╖Uint8Array;ΓÉì
     22     Γöé - }ΓÉì
     23     Γöé - ΓÉì
     24     Γöé - export┬╖function┬╖parseSkillMeta(content:┬╖string):┬╖SkillMeta┬╖|┬╖null┬╖{ΓÉì
     25     Γöé - ┬╖┬╖const┬╖match┬╖=┬╖content.match(/^---\s*\n([\s\S]*?)\n---/);ΓÉì
     26     Γöé - ┬╖┬╖if┬╖(!match)┬╖return┬╖null;ΓÉì
     27     Γöé - ΓÉì
     28     Γöé - ┬╖┬╖const┬╖yaml┬╖=┬╖match[1];ΓÉì
     29     Γöé - ┬╖┬╖const┬╖name┬╖=┬╖yaml.match(/^name:\s*(.+)$/m)?.[1]?.trim();ΓÉì
     30     Γöé - ┬╖┬╖const┬╖description┬╖=┬╖yaml.match(/^description:\s*(.+)$/m)?.[1]?.trim();ΓÉì
     31     Γöé - ┬╖┬╖const┬╖platform┬╖=┬╖yaml.match(/^platform:\s*(.+)$/m)?.[1]?.trim();ΓÉì
     32     Γöé - ΓÉì
     33     Γöé - ┬╖┬╖if┬╖(!name┬╖||┬╖!description)┬╖return┬╖null;ΓÉì
     34     Γöé - ┬╖┬╖return┬╖{┬╖name,┬╖description,┬╖...(platform┬╖?┬╖{┬╖platform┬╖}┬╖:┬╖{})┬╖};ΓÉì
     35     Γöé - }ΓÉì
     36     Γöé - ΓÉì
     37     Γöé - function┬╖toUint8Array(data:┬╖string┬╖|┬╖Uint8Array):┬╖Uint8Array┬╖{ΓÉì
     38     Γöé - ┬╖┬╖return┬╖typeof┬╖data┬╖===┬╖"string"┬╖?┬╖encoder.encode(data)┬╖:┬╖data;ΓÉì
     39     Γöé - }ΓÉì
     40     Γöé - ΓÉì
     41     Γöé - function┬╖findSkillMd(files:┬╖SkillInput[]):┬╖SkillInput┬╖|┬╖undefined┬╖{ΓÉì
     42     Γöé - ┬╖┬╖return┬╖files.find((f)┬╖=>┬╖{ΓÉì
     43     Γöé - ┬╖┬╖┬╖┬╖const┬╖name┬╖=┬╖f.path.split("/").pop();ΓÉì
     44     Γöé - ┬╖┬╖┬╖┬╖return┬╖name┬╖===┬╖"SKILL.md";ΓÉì
     45     Γöé - ┬╖┬╖});ΓÉì
     46     Γöé - }ΓÉì
     47     Γöé - ΓÉì
     48     Γöé - function┬╖normalizeFiles(ΓÉì
     49     Γöé - ┬╖┬╖files:┬╖SkillInput[],ΓÉì
     50     Γöé - ):┬╖{┬╖path:┬╖string;┬╖data:┬╖Uint8Array┬╖}[]┬╖{ΓÉì
     51     Γöé - ┬╖┬╖return┬╖files.map((f)┬╖=>┬╖({ΓÉì
     52     Γöé - ┬╖┬╖┬╖┬╖path:┬╖f.path.replace(/^\.\//,┬╖""),ΓÉì
     53     Γöé - ┬╖┬╖┬╖┬╖data:┬╖toUint8Array(f.data),ΓÉì
     54     Γöé - ┬╖┬╖}));ΓÉì
     55     Γöé - }ΓÉì
     56     Γöé - ΓÉì
     57     Γöé - export┬╖async┬╖function┬╖addSkill(files:┬╖SkillInput[]):┬╖Promise<SkillMeta>┬╖{ΓÉì
     58     Γöé - ┬╖┬╖const┬╖skillMd┬╖=┬╖findSkillMd(files);ΓÉì
     59     Γöé - ┬╖┬╖if┬╖(!skillMd)┬╖{ΓÉì
     60     Γöé - ┬╖┬╖┬╖┬╖throw┬╖new┬╖Error("Skill┬╖must┬╖contain┬╖a┬╖SKILL.md┬╖file");ΓÉì
     61     Γöé - ┬╖┬╖}ΓÉì
     62     Γöé - ΓÉì
     63     Γöé - ┬╖┬╖const┬╖content┬╖=ΓÉì
     64     Γöé - ┬╖┬╖┬╖┬╖typeof┬╖skillMd.data┬╖===┬╖"string"ΓÉì
     65     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖?┬╖skillMd.dataΓÉì
     66     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖:┬╖decoder.decode(skillMd.data);ΓÉì
     67     Γöé - ┬╖┬╖const┬╖meta┬╖=┬╖parseSkillMeta(content);ΓÉì
     68     Γöé - ┬╖┬╖if┬╖(!meta)┬╖{ΓÉì
     69     Γöé - ┬╖┬╖┬╖┬╖throw┬╖new┬╖Error(ΓÉì
     70     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"SKILL.md┬╖must┬╖have┬╖valid┬╖frontmatter┬╖with┬╖name┬╖and┬╖description",ΓÉì
     71     Γöé - ┬╖┬╖┬╖┬╖);ΓÉì
     72     Γöé - ┬╖┬╖}ΓÉì
     73     Γöé - ΓÉì
     74     Γöé - ┬╖┬╖await┬╖saveSkillFiles(meta.name,┬╖normalizeFiles(files));ΓÉì
     75     Γöé - ┬╖┬╖await┬╖syncSkillsToVfs();ΓÉì
     76     Γöé - ┬╖┬╖return┬╖meta;ΓÉì
     77     Γöé - }ΓÉì
     78     Γöé - ΓÉì
     79     Γöé - export┬╖async┬╖function┬╖removeSkill(name:┬╖string):┬╖Promise<void>┬╖{ΓÉì
     80     Γöé - ┬╖┬╖await┬╖deleteSkillFiles(name);ΓÉì
     81     Γöé - ┬╖┬╖await┬╖syncSkillsToVfs();ΓÉì
     82     Γöé - }ΓÉì
     83     Γöé - ΓÉì
     84     Γöé - export┬╖async┬╖function┬╖getInstalledSkills():┬╖Promise<SkillMeta[]>┬╖{ΓÉì
     85     Γöé - ┬╖┬╖const┬╖names┬╖=┬╖await┬╖listSkillNames();ΓÉì
     86     Γöé - ┬╖┬╖const┬╖skills:┬╖SkillMeta[]┬╖=┬╖[];ΓÉì
     87     Γöé - ΓÉì
     88     Γöé - ┬╖┬╖for┬╖(const┬╖name┬╖of┬╖names)┬╖{ΓÉì
     89     Γöé - ┬╖┬╖┬╖┬╖const┬╖files┬╖=┬╖await┬╖loadSkillFiles(name);ΓÉì
     90     Γöé - ┬╖┬╖┬╖┬╖const┬╖skillMd┬╖=┬╖files.find((f)┬╖=>┬╖f.path┬╖===┬╖"SKILL.md");ΓÉì
     91     Γöé - ┬╖┬╖┬╖┬╖if┬╖(skillMd)┬╖{ΓÉì
     92     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖content┬╖=┬╖decoder.decode(skillMd.data);ΓÉì
     93     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖meta┬╖=┬╖parseSkillMeta(content);ΓÉì
     94     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(meta)┬╖{ΓÉì
     95     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖skills.push(meta);ΓÉì
     96     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖continue;ΓÉì
     97     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     98     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖skills.push({┬╖name,┬╖description:┬╖""┬╖});ΓÉì
    100     Γöé - ┬╖┬╖}ΓÉì
    101     Γöé - ΓÉì
    102     Γöé - ┬╖┬╖return┬╖skills;ΓÉì
    103     Γöé - }ΓÉì
    104     Γöé - ΓÉì
    105     Γöé - export┬╖async┬╖function┬╖syncSkillsToVfs():┬╖Promise<void>┬╖{ΓÉì
    106     Γöé - ┬╖┬╖const┬╖allFiles┬╖=┬╖await┬╖loadAllSkillFiles();ΓÉì
    107     Γöé - ┬╖┬╖const┬╖initialFiles:┬╖Record<string,┬╖Uint8Array>┬╖=┬╖{};ΓÉì
    108     Γöé - ┬╖┬╖for┬╖(const┬╖f┬╖of┬╖allFiles)┬╖{ΓÉì
    109     Γöé - ┬╖┬╖┬╖┬╖initialFiles[`/home/skills/${f.skillName}/${f.path}`]┬╖=┬╖f.data;ΓÉì
    110     Γöé - ┬╖┬╖}ΓÉì
    111     Γöé - ┬╖┬╖setSkillFiles(initialFiles);ΓÉì
    112     Γöé - }ΓÉì
    113     Γöé - ΓÉì
    114     Γöé - export┬╖function┬╖buildSkillsPromptSection(skills:┬╖SkillMeta[]):┬╖string┬╖{ΓÉì
    115     Γöé - ┬╖┬╖if┬╖(skills.length┬╖===┬╖0)┬╖return┬╖"";ΓÉì
    116     Γöé - ΓÉì
    117     Γöé - ┬╖┬╖const┬╖entries┬╖=┬╖skills.map(ΓÉì
    118     Γöé - ┬╖┬╖┬╖┬╖(s)┬╖=>┬╖`┬╖┬╖<skill>ΓÉì
    119     Γöé - ┬╖┬╖┬╖┬╖<name>${s.name}</name>ΓÉì
    120     Γöé - ┬╖┬╖┬╖┬╖<description>${s.description}</description>ΓÉì
    121     Γöé - ┬╖┬╖┬╖┬╖<location>/home/skills/${s.name}/SKILL.md</location>ΓÉì
    122     Γöé - ┬╖┬╖</skill>`,ΓÉì
    123     Γöé - ┬╖┬╖);ΓÉì
    124     Γöé - ΓÉì
    125     Γöé - ┬╖┬╖return┬╖`ΓÉì
    126     Γöé - ΓÉì
    127     Γöé - The┬╖following┬╖skills┬╖provide┬╖specialized┬╖instructions┬╖for┬╖specific┬╖tasks.ΓÉì
    128     Γöé - Use┬╖the┬╖read┬╖tool┬╖to┬╖load┬╖a┬╖skill's┬╖file┬╖when┬╖the┬╖task┬╖matches┬╖its┬╖description.ΓÉì
    129     Γöé - When┬╖a┬╖skill┬╖file┬╖references┬╖a┬╖relative┬╖path,┬╖resolve┬╖it┬╖against┬╖the┬╖skill┬╖directory┬╖and┬╖use┬╖that┬╖absolute┬╖path.ΓÉì
    130     Γöé - ΓÉì
    131     Γöé - <available_skills>ΓÉì
    132     Γöé - ${entries.join("\n")}ΓÉì
    133     Γöé - </available_skills>`;ΓÉì
    134     Γöé - }ΓÉì
          1 Γöé + import┬╖{
          2 Γöé + ┬╖┬╖deleteSkillFiles,
          3 Γöé + ┬╖┬╖listSkillNames,
          4 Γöé + ┬╖┬╖loadAllSkillFiles,
          5 Γöé + ┬╖┬╖loadSkillFiles,
          6 Γöé + ┬╖┬╖saveSkillFiles,
          7 Γöé + }┬╖from┬╖"../storage";
          8 Γöé + import┬╖{┬╖setSkillFiles┬╖}┬╖from┬╖"../vfs";
          9 Γöé + 
         10 Γöé + const┬╖encoder┬╖=┬╖new┬╖TextEncoder();
         11 Γöé + const┬╖decoder┬╖=┬╖new┬╖TextDecoder();
         12 Γöé + 
         13 Γöé + export┬╖interface┬╖SkillMeta┬╖{
         14 Γöé + ┬╖┬╖name:┬╖string;
         15 Γöé + ┬╖┬╖description:┬╖string;
         16 Γöé + ┬╖┬╖platform?:┬╖string;
  119 more lines truncated
  

src\lib\storage\index.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - export┬╖type┬╖{┬╖ChatSession,┬╖SkillFile┬╖}┬╖from┬╖"./db";ΓÉì
     2    Γöé - export┬╖{ΓÉì
     3    Γöé - ┬╖┬╖createSession,ΓÉì
     4    Γöé - ┬╖┬╖deleteSession,ΓÉì
     5    Γöé - ┬╖┬╖deleteSkillFiles,ΓÉì
     6    Γöé - ┬╖┬╖deleteVfsFiles,ΓÉì
     7    Γöé - ┬╖┬╖getOrCreateCurrentSession,ΓÉì
     8    Γöé - ┬╖┬╖getOrCreateWorkbookId,ΓÉì
     9    Γöé - ┬╖┬╖getSession,ΓÉì
    10    Γöé - ┬╖┬╖getSessionMessageCount,ΓÉì
    11    Γöé - ┬╖┬╖listSessions,ΓÉì
    12    Γöé - ┬╖┬╖listSkillNames,ΓÉì
    13    Γöé - ┬╖┬╖loadAllSkillFiles,ΓÉì
    14    Γöé - ┬╖┬╖loadSkillFiles,ΓÉì
    15    Γöé - ┬╖┬╖loadVfsFiles,ΓÉì
    16    Γöé - ┬╖┬╖renameSession,ΓÉì
    17    Γöé - ┬╖┬╖saveSession,ΓÉì
    18    Γöé - ┬╖┬╖saveSkillFiles,ΓÉì
    19    Γöé - ┬╖┬╖saveVfsFiles,ΓÉì
    20    Γöé - }┬╖from┬╖"./db";ΓÉì
        1 Γöé + export┬╖type┬╖{┬╖ChatSession,┬╖SkillFile┬╖}┬╖from┬╖"./db";
        2 Γöé + export┬╖{
        3 Γöé + ┬╖┬╖createSession,
        4 Γöé + ┬╖┬╖deleteSession,
        5 Γöé + ┬╖┬╖deleteSkillFiles,
        6 Γöé + ┬╖┬╖deleteVfsFiles,
        7 Γöé + ┬╖┬╖getOrCreateCurrentSession,
        8 Γöé + ┬╖┬╖getOrCreateWorkbookId,
        9 Γöé + ┬╖┬╖getSession,
       10 Γöé + ┬╖┬╖getSessionMessageCount,
       11 Γöé + ┬╖┬╖listSessions,
       12 Γöé + ┬╖┬╖listSkillNames,
       13 Γöé + ┬╖┬╖loadAllSkillFiles,
       14 Γöé + ┬╖┬╖loadSkillFiles,
       15 Γöé + ┬╖┬╖loadVfsFiles,
       16 Γöé + ┬╖┬╖renameSession,
       17 Γöé + ┬╖┬╖saveSession,
       18 Γöé + ┬╖┬╖saveSkillFiles,
       19 Γöé + ┬╖┬╖saveVfsFiles,
       20 Γöé + }┬╖from┬╖"./db";
    21 21 Γöé   
  

src\lib\tools\bash.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";ΓÉì
     2    Γöé - import┬╖{ΓÉì
     3    Γöé - ┬╖┬╖DEFAULT_MAX_BYTES,ΓÉì
     4    Γöé - ┬╖┬╖DEFAULT_MAX_LINES,ΓÉì
     5    Γöé - ┬╖┬╖formatSize,ΓÉì
     6    Γöé - ┬╖┬╖truncateTail,ΓÉì
     7    Γöé - }┬╖from┬╖"../truncate";ΓÉì
     8    Γöé - import┬╖{┬╖getBash┬╖}┬╖from┬╖"../vfs";ΓÉì
     9    Γöé - import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";ΓÉì
    10    Γöé - ΓÉì
    11    Γöé - export┬╖const┬╖bashTool┬╖=┬╖defineTool({ΓÉì
    12    Γöé - ┬╖┬╖name:┬╖"bash",ΓÉì
    13    Γöé - ┬╖┬╖label:┬╖"Bash",ΓÉì
    14    Γöé - ┬╖┬╖description:ΓÉì
    15    Γöé - ┬╖┬╖┬╖┬╖"Execute┬╖bash┬╖commands┬╖in┬╖a┬╖sandboxed┬╖virtual┬╖environment.┬╖"┬╖+ΓÉì
    16    Γöé - ┬╖┬╖┬╖┬╖`Output┬╖is┬╖truncated┬╖to┬╖last┬╖${DEFAULT_MAX_LINES}┬╖lines┬╖or┬╖${DEFAULT_MAX_BYTES┬╖/┬╖1024}KB┬╖(whichever┬╖is┬╖hit┬╖first).┬╖`┬╖+ΓÉì
    17    Γöé - ┬╖┬╖┬╖┬╖"The┬╖filesystem┬╖is┬╖in-memory┬╖with┬╖user┬╖uploads┬╖in┬╖/home/user/uploads/.┬╖"┬╖+ΓÉì
    18    Γöé - ┬╖┬╖┬╖┬╖"Useful┬╖for:┬╖file┬╖operations┬╖(ls,┬╖cat,┬╖grep,┬╖find),┬╖text┬╖processing┬╖(awk,┬╖sed,┬╖jq,┬╖sort,┬╖uniq),┬╖"┬╖+ΓÉì
    19    Γöé - ┬╖┬╖┬╖┬╖"data┬╖analysis┬╖(wc,┬╖cut,┬╖paste),┬╖and┬╖general┬╖scripting.┬╖"┬╖+ΓÉì
    20    Γöé - ┬╖┬╖┬╖┬╖"Network┬╖access┬╖is┬╖disabled.┬╖No┬╖external┬╖runtimes┬╖(node,┬╖python,┬╖etc.)┬╖are┬╖available.",ΓÉì
    21    Γöé - ┬╖┬╖parameters:┬╖Type.Object({ΓÉì
    22    Γöé - ┬╖┬╖┬╖┬╖command:┬╖Type.String({ΓÉì
    23    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖description:ΓÉì
    24    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖"Bash┬╖command(s)┬╖to┬╖execute.┬╖Can┬╖be┬╖a┬╖single┬╖command┬╖or┬╖a┬╖script┬╖with┬╖multiple┬╖lines.┬╖"┬╖+ΓÉì
    25    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖"Supports┬╖pipes┬╖(|),┬╖redirections┬╖(>,┬╖>>),┬╖command┬╖chaining┬╖(&&,┬╖||,┬╖;),┬╖"┬╖+ΓÉì
    26    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖"variables,┬╖loops,┬╖conditionals,┬╖and┬╖functions.",ΓÉì
    27    Γöé - ┬╖┬╖┬╖┬╖}),ΓÉì
    28    Γöé - ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(ΓÉì
    29    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({ΓÉì
    30    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",ΓÉì
    31    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,ΓÉì
    32    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}),ΓÉì
    33    Γöé - ┬╖┬╖┬╖┬╖),ΓÉì
    34    Γöé - ┬╖┬╖}),ΓÉì
    35    Γöé - ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{ΓÉì
    36    Γöé - ┬╖┬╖┬╖┬╖try┬╖{ΓÉì
    37    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖bash┬╖=┬╖getBash();ΓÉì
    38    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖bash.exec(params.command);ΓÉì
    39    Γöé - ΓÉì
    40    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖let┬╖output┬╖=┬╖"";ΓÉì
    41    Γöé - ΓÉì
    42    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(result.stdout)┬╖{ΓÉì
    43    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖+=┬╖result.stdout;ΓÉì
    44    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    45    Γöé - ΓÉì
    46    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(result.stderr)┬╖{ΓÉì
    47    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(output┬╖&&┬╖!output.endsWith("\n"))┬╖output┬╖+=┬╖"\n";ΓÉì
    48    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖+=┬╖`stderr:┬╖${result.stderr}`;ΓÉì
    49    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    50    Γöé - ΓÉì
    51    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(result.exitCode┬╖!==┬╖0)┬╖{ΓÉì
    52    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(output┬╖&&┬╖!output.endsWith("\n"))┬╖output┬╖+=┬╖"\n";ΓÉì
    53    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖+=┬╖`[exit┬╖code:┬╖${result.exitCode}]`;ΓÉì
    54    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    55    Γöé - ΓÉì
    56    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(!output)┬╖{ΓÉì
    57    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖=┬╖"[no┬╖output]";ΓÉì
    58    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    59    Γöé - ΓÉì
    60    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖output┬╖=┬╖output.trim();ΓÉì
    61    Γöé - ΓÉì
    62    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖truncation┬╖=┬╖truncateTail(output);ΓÉì
    63    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖let┬╖outputText┬╖=┬╖truncation.content;ΓÉì
    64    Γöé - ΓÉì
    65    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(truncation.truncated)┬╖{ΓÉì
    66    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖startLine┬╖=┬╖truncation.totalLines┬╖-┬╖truncation.outputLines┬╖+┬╖1;ΓÉì
    67    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖endLine┬╖=┬╖truncation.totalLines;ΓÉì
    68    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(truncation.truncatedBy┬╖===┬╖"lines")┬╖{ΓÉì
    69    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖outputText┬╖+=┬╖`\n\n[Showing┬╖last┬╖${truncation.outputLines}┬╖of┬╖${truncation.totalLines}┬╖lines.┬╖Output┬╖truncated.]`;ΓÉì
    70    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}┬╖else┬╖{ΓÉì
    71    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖outputText┬╖+=┬╖`\n\n[Showing┬╖lines┬╖${startLine}-${endLine}┬╖of┬╖${truncation.totalLines}┬╖(${formatSize(DEFAULT_MAX_BYTES)}┬╖limit).┬╖Output┬╖truncated.]`;ΓÉì
    72    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    73    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
    74    Γöé - ΓÉì
    75    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess({┬╖output:┬╖outputText,┬╖exitCode:┬╖result.exitCode┬╖});ΓÉì
    76    Γöé - ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{ΓÉì
    77    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=ΓÉì
    78    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖ErrorΓÉì
    79    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖?┬╖error.messageΓÉì
    80    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖:┬╖"Unknown┬╖error┬╖executing┬╖bash┬╖command";ΓÉì
    81    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);ΓÉì
    82    Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
    83    Γöé - ┬╖┬╖},ΓÉì
    84    Γöé - });ΓÉì
        1 Γöé + import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";
        2 Γöé + import┬╖{
        3 Γöé + ┬╖┬╖DEFAULT_MAX_BYTES,
        4 Γöé + ┬╖┬╖DEFAULT_MAX_LINES,
        5 Γöé + ┬╖┬╖formatSize,
        6 Γöé + ┬╖┬╖truncateTail,
        7 Γöé + }┬╖from┬╖"../truncate";
        8 Γöé + import┬╖{┬╖getBash┬╖}┬╖from┬╖"../vfs";
        9 Γöé + import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";
       10 Γöé + 
       11 Γöé + export┬╖const┬╖bashTool┬╖=┬╖defineTool({
       12 Γöé + ┬╖┬╖name:┬╖"bash",
       13 Γöé + ┬╖┬╖label:┬╖"Bash",
       14 Γöé + ┬╖┬╖description:
       15 Γöé + ┬╖┬╖┬╖┬╖"Execute┬╖bash┬╖commands┬╖in┬╖a┬╖sandboxed┬╖virtual┬╖environment.┬╖"┬╖+
       16 Γöé + ┬╖┬╖┬╖┬╖`Output┬╖is┬╖truncated┬╖to┬╖last┬╖${DEFAULT_MAX_LINES}┬╖lines┬╖or┬╖${DEFAULT_MAX_BYTES┬╖/┬╖1024}KB┬╖(whichever┬╖is┬╖hit┬╖first).┬╖`┬╖+
       17 Γöé + ┬╖┬╖┬╖┬╖"The┬╖filesystem┬╖is┬╖in-memory┬╖with┬╖user┬╖uploads┬╖in┬╖/home/user/uploads/.┬╖"┬╖+
       18 Γöé + ┬╖┬╖┬╖┬╖"Useful┬╖for:┬╖file┬╖operations┬╖(ls,┬╖cat,┬╖grep,┬╖find),┬╖text┬╖processing┬╖(awk,┬╖sed,┬╖jq,┬╖sort,┬╖uniq),┬╖"┬╖+
       19 Γöé + ┬╖┬╖┬╖┬╖"data┬╖analysis┬╖(wc,┬╖cut,┬╖paste),┬╖and┬╖general┬╖scripting.┬╖"┬╖+
       20 Γöé + ┬╖┬╖┬╖┬╖"Network┬╖access┬╖is┬╖disabled.┬╖No┬╖external┬╖runtimes┬╖(node,┬╖python,┬╖etc.)┬╖are┬╖available.",
       21 Γöé + ┬╖┬╖parameters:┬╖Type.Object({
       22 Γöé + ┬╖┬╖┬╖┬╖command:┬╖Type.String({
       23 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖description:
       24 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖"Bash┬╖command(s)┬╖to┬╖execute.┬╖Can┬╖be┬╖a┬╖single┬╖command┬╖or┬╖a┬╖script┬╖with┬╖multiple┬╖lines.┬╖"┬╖+
       25 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖"Supports┬╖pipes┬╖(|),┬╖redirections┬╖(>,┬╖>>),┬╖command┬╖chaining┬╖(&&,┬╖||,┬╖;),┬╖"┬╖+
       26 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖"variables,┬╖loops,┬╖conditionals,┬╖and┬╖functions.",
       27 Γöé + ┬╖┬╖┬╖┬╖}),
       28 Γöé + ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(
       29 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({
       30 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",
       31 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,
       32 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}),
       33 Γöé + ┬╖┬╖┬╖┬╖),
       34 Γöé + ┬╖┬╖}),
       35 Γöé + ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{
       36 Γöé + ┬╖┬╖┬╖┬╖try┬╖{
       37 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖bash┬╖=┬╖getBash();
       38 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖bash.exec(params.command);
       39 Γöé + 
       40 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖let┬╖output┬╖=┬╖"";
       41 Γöé + 
       42 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(result.stdout)┬╖{
       43 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖+=┬╖result.stdout;
       44 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}
       45 Γöé + 
       46 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(result.stderr)┬╖{
       47 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(output┬╖&&┬╖!output.endsWith("\n"))┬╖output┬╖+=┬╖"\n";
       48 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖+=┬╖`stderr:┬╖${result.stderr}`;
       49 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}
       50 Γöé + 
       51 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(result.exitCode┬╖!==┬╖0)┬╖{
       52 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(output┬╖&&┬╖!output.endsWith("\n"))┬╖output┬╖+=┬╖"\n";
       53 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖+=┬╖`[exit┬╖code:┬╖${result.exitCode}]`;
       54 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}
       55 Γöé + 
       56 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(!output)┬╖{
       57 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖output┬╖=┬╖"[no┬╖output]";
       58 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}
       59 Γöé + 
       60 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖output┬╖=┬╖output.trim();
       61 Γöé + 
       62 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖truncation┬╖=┬╖truncateTail(output);
       63 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖let┬╖outputText┬╖=┬╖truncation.content;
       64 Γöé + 
       65 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(truncation.truncated)┬╖{
       66 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖const┬╖startLine┬╖=┬╖truncation.totalLines┬╖-┬╖truncation.outputLines┬╖+┬╖1;
  19 more lines truncated
  

src\lib\tools\clear-cell-range.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";ΓÉì
     2    Γöé - import┬╖{┬╖clearCellRange┬╖}┬╖from┬╖"../excel/api";ΓÉì
     3    Γöé - import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";ΓÉì
     4    Γöé - ΓÉì
     5    Γöé - export┬╖const┬╖clearCellRangeTool┬╖=┬╖defineTool({ΓÉì
     6    Γöé - ┬╖┬╖name:┬╖"clear_cell_range",ΓÉì
     7    Γöé - ┬╖┬╖label:┬╖"Clear┬╖Cell┬╖Range",ΓÉì
     8    Γöé - ┬╖┬╖description:ΓÉì
     9    Γöé - ┬╖┬╖┬╖┬╖"Clear┬╖contents,┬╖formatting,┬╖or┬╖both┬╖from┬╖a┬╖range┬╖of┬╖cells.┬╖"┬╖+ΓÉì
    10    Γöé - ┬╖┬╖┬╖┬╖"Use┬╖'contents'┬╖to┬╖keep┬╖formatting,┬╖'formats'┬╖to┬╖keep┬╖values,┬╖'all'┬╖to┬╖clear┬╖everything.",ΓÉì
    11    Γöé - ┬╖┬╖parameters:┬╖Type.Object({ΓÉì
    12    Γöé - ┬╖┬╖┬╖┬╖sheetId:┬╖Type.Number({┬╖description:┬╖"The┬╖worksheet┬╖ID┬╖(1-based┬╖index)"┬╖}),ΓÉì
    13    Γöé - ┬╖┬╖┬╖┬╖range:┬╖Type.String({┬╖description:┬╖"Range┬╖to┬╖clear┬╖in┬╖A1┬╖notation"┬╖}),ΓÉì
    14    Γöé - ┬╖┬╖┬╖┬╖clearType:┬╖Type.Optional(ΓÉì
    15    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Type.Union(ΓÉì
    16    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖[ΓÉì
    17    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Type.Literal("contents"),ΓÉì
    18    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Type.Literal("all"),ΓÉì
    19    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Type.Literal("formats"),ΓÉì
    20    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖],ΓÉì
    21    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖{ΓÉì
    22    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"What┬╖to┬╖clear.┬╖Default:┬╖'contents'",ΓÉì
    23    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖},ΓÉì
    24    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖),ΓÉì
    25    Γöé - ┬╖┬╖┬╖┬╖),ΓÉì
    26    Γöé - ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(ΓÉì
    27    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({ΓÉì
    28    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",ΓÉì
    29    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,ΓÉì
    30    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}),ΓÉì
    31    Γöé - ┬╖┬╖┬╖┬╖),ΓÉì
    32    Γöé - ┬╖┬╖}),ΓÉì
    33    Γöé - ┬╖┬╖dirtyTracking:┬╖{ΓÉì
    34    Γöé - ┬╖┬╖┬╖┬╖getRanges:┬╖(p)┬╖=>┬╖[{┬╖sheetId:┬╖p.sheetId,┬╖range:┬╖p.range┬╖}],ΓÉì
    35    Γöé - ┬╖┬╖},ΓÉì
    36    Γöé - ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{ΓÉì
    37    Γöé - ┬╖┬╖┬╖┬╖try┬╖{ΓÉì
    38    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖clearCellRange(ΓÉì
    39    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.sheetId,ΓÉì
    40    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.range,ΓÉì
    41    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.clearType,ΓÉì
    42    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖);ΓÉì
    43    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess(result);ΓÉì
    44    Γöé - ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{ΓÉì
    45    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=ΓÉì
    46    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖Error┬╖?┬╖error.message┬╖:┬╖"Unknown┬╖error┬╖clearing┬╖cells";ΓÉì
    47    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);ΓÉì
    48    Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
    49    Γöé - ┬╖┬╖},ΓÉì
    50    Γöé - });ΓÉì
        1 Γöé + import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";
        2 Γöé + import┬╖{┬╖clearCellRange┬╖}┬╖from┬╖"../excel/api";
        3 Γöé + import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";
        4 Γöé + 
        5 Γöé + export┬╖const┬╖clearCellRangeTool┬╖=┬╖defineTool({
        6 Γöé + ┬╖┬╖name:┬╖"clear_cell_range",
        7 Γöé + ┬╖┬╖label:┬╖"Clear┬╖Cell┬╖Range",
        8 Γöé + ┬╖┬╖description:
        9 Γöé + ┬╖┬╖┬╖┬╖"Clear┬╖contents,┬╖formatting,┬╖or┬╖both┬╖from┬╖a┬╖range┬╖of┬╖cells.┬╖"┬╖+
       10 Γöé + ┬╖┬╖┬╖┬╖"Use┬╖'contents'┬╖to┬╖keep┬╖formatting,┬╖'formats'┬╖to┬╖keep┬╖values,┬╖'all'┬╖to┬╖clear┬╖everything.",
       11 Γöé + ┬╖┬╖parameters:┬╖Type.Object({
       12 Γöé + ┬╖┬╖┬╖┬╖sheetId:┬╖Type.Number({┬╖description:┬╖"The┬╖worksheet┬╖ID┬╖(1-based┬╖index)"┬╖}),
       13 Γöé + ┬╖┬╖┬╖┬╖range:┬╖Type.String({┬╖description:┬╖"Range┬╖to┬╖clear┬╖in┬╖A1┬╖notation"┬╖}),
       14 Γöé + ┬╖┬╖┬╖┬╖clearType:┬╖Type.Optional(
       15 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Type.Union(
       16 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖[
       17 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Type.Literal("contents"),
       18 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Type.Literal("all"),
       19 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Type.Literal("formats"),
       20 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖],
       21 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖{
       22 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"What┬╖to┬╖clear.┬╖Default:┬╖'contents'",
       23 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖},
       24 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖),
       25 Γöé + ┬╖┬╖┬╖┬╖),
       26 Γöé + ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(
       27 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({
       28 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",
       29 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,
       30 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}),
       31 Γöé + ┬╖┬╖┬╖┬╖),
       32 Γöé + ┬╖┬╖}),
       33 Γöé + ┬╖┬╖dirtyTracking:┬╖{
       34 Γöé + ┬╖┬╖┬╖┬╖getRanges:┬╖(p)┬╖=>┬╖[{┬╖sheetId:┬╖p.sheetId,┬╖range:┬╖p.range┬╖}],
       35 Γöé + ┬╖┬╖},
       36 Γöé + ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{
       37 Γöé + ┬╖┬╖┬╖┬╖try┬╖{
       38 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖clearCellRange(
       39 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.sheetId,
       40 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.range,
       41 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.clearType,
       42 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖);
       43 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess(result);
       44 Γöé + ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{
       45 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=
       46 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖Error┬╖?┬╖error.message┬╖:┬╖"Unknown┬╖error┬╖clearing┬╖cells";
       47 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);
       48 Γöé + ┬╖┬╖┬╖┬╖}
       49 Γöé + ┬╖┬╖},
       50 Γöé + });
    51 51 Γöé   
  

src\lib\tools\copy-to.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";ΓÉì
     2    Γöé - import┬╖{┬╖copyTo┬╖}┬╖from┬╖"../excel/api";ΓÉì
     3    Γöé - import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";ΓÉì
     4    Γöé - ΓÉì
     5    Γöé - export┬╖const┬╖copyToTool┬╖=┬╖defineTool({ΓÉì
     6    Γöé - ┬╖┬╖name:┬╖"copy_to",ΓÉì
     7    Γöé - ┬╖┬╖label:┬╖"Copy┬╖To",ΓÉì
     8    Γöé - ┬╖┬╖description:ΓÉì
     9    Γöé - ┬╖┬╖┬╖┬╖"Copy┬╖a┬╖range┬╖to┬╖another┬╖location┬╖with┬╖formula┬╖translation.┬╖"┬╖+ΓÉì
    10    Γöé - ┬╖┬╖┬╖┬╖"If┬╖destination┬╖is┬╖larger,┬╖the┬╖source┬╖pattern┬╖repeats.┬╖"┬╖+ΓÉì
    11    Γöé - ┬╖┬╖┬╖┬╖"Great┬╖for┬╖filling┬╖formulas┬╖down┬╖a┬╖column.",ΓÉì
    12    Γöé - ┬╖┬╖parameters:┬╖Type.Object({ΓÉì
    13    Γöé - ┬╖┬╖┬╖┬╖sheetId:┬╖Type.Number({┬╖description:┬╖"The┬╖worksheet┬╖ID┬╖(1-based┬╖index)"┬╖}),ΓÉì
    14    Γöé - ┬╖┬╖┬╖┬╖sourceRange:┬╖Type.String({┬╖description:┬╖"Source┬╖range┬╖in┬╖A1┬╖notation"┬╖}),ΓÉì
    15    Γöé - ┬╖┬╖┬╖┬╖destinationRange:┬╖Type.String({ΓÉì
    16    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Destination┬╖range┬╖in┬╖A1┬╖notation",ΓÉì
    17    Γöé - ┬╖┬╖┬╖┬╖}),ΓÉì
    18    Γöé - ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(ΓÉì
    19    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({ΓÉì
    20    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",ΓÉì
    21    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,ΓÉì
    22    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}),ΓÉì
    23    Γöé - ┬╖┬╖┬╖┬╖),ΓÉì
    24    Γöé - ┬╖┬╖}),ΓÉì
    25    Γöé - ┬╖┬╖dirtyTracking:┬╖{ΓÉì
    26    Γöé - ┬╖┬╖┬╖┬╖getRanges:┬╖(p)┬╖=>┬╖[{┬╖sheetId:┬╖p.sheetId,┬╖range:┬╖p.destinationRange┬╖}],ΓÉì
    27    Γöé - ┬╖┬╖},ΓÉì
    28    Γöé - ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{ΓÉì
    29    Γöé - ┬╖┬╖┬╖┬╖try┬╖{ΓÉì
    30    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖copyTo(ΓÉì
    31    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.sheetId,ΓÉì
    32    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.sourceRange,ΓÉì
    33    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.destinationRange,ΓÉì
    34    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖);ΓÉì
    35    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess(result);ΓÉì
    36    Γöé - ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{ΓÉì
    37    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=ΓÉì
    38    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖Error┬╖?┬╖error.message┬╖:┬╖"Unknown┬╖error┬╖copying┬╖range";ΓÉì
    39    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);ΓÉì
    40    Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
    41    Γöé - ┬╖┬╖},ΓÉì
    42    Γöé - });ΓÉì
        1 Γöé + import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";
        2 Γöé + import┬╖{┬╖copyTo┬╖}┬╖from┬╖"../excel/api";
        3 Γöé + import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";
        4 Γöé + 
        5 Γöé + export┬╖const┬╖copyToTool┬╖=┬╖defineTool({
        6 Γöé + ┬╖┬╖name:┬╖"copy_to",
        7 Γöé + ┬╖┬╖label:┬╖"Copy┬╖To",
        8 Γöé + ┬╖┬╖description:
        9 Γöé + ┬╖┬╖┬╖┬╖"Copy┬╖a┬╖range┬╖to┬╖another┬╖location┬╖with┬╖formula┬╖translation.┬╖"┬╖+
       10 Γöé + ┬╖┬╖┬╖┬╖"If┬╖destination┬╖is┬╖larger,┬╖the┬╖source┬╖pattern┬╖repeats.┬╖"┬╖+
       11 Γöé + ┬╖┬╖┬╖┬╖"Great┬╖for┬╖filling┬╖formulas┬╖down┬╖a┬╖column.",
       12 Γöé + ┬╖┬╖parameters:┬╖Type.Object({
       13 Γöé + ┬╖┬╖┬╖┬╖sheetId:┬╖Type.Number({┬╖description:┬╖"The┬╖worksheet┬╖ID┬╖(1-based┬╖index)"┬╖}),
       14 Γöé + ┬╖┬╖┬╖┬╖sourceRange:┬╖Type.String({┬╖description:┬╖"Source┬╖range┬╖in┬╖A1┬╖notation"┬╖}),
       15 Γöé + ┬╖┬╖┬╖┬╖destinationRange:┬╖Type.String({
       16 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Destination┬╖range┬╖in┬╖A1┬╖notation",
       17 Γöé + ┬╖┬╖┬╖┬╖}),
       18 Γöé + ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(
       19 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({
       20 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",
       21 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,
       22 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}),
       23 Γöé + ┬╖┬╖┬╖┬╖),
       24 Γöé + ┬╖┬╖}),
       25 Γöé + ┬╖┬╖dirtyTracking:┬╖{
       26 Γöé + ┬╖┬╖┬╖┬╖getRanges:┬╖(p)┬╖=>┬╖[{┬╖sheetId:┬╖p.sheetId,┬╖range:┬╖p.destinationRange┬╖}],
       27 Γöé + ┬╖┬╖},
       28 Γöé + ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{
       29 Γöé + ┬╖┬╖┬╖┬╖try┬╖{
       30 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖copyTo(
       31 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.sheetId,
       32 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.sourceRange,
       33 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖params.destinationRange,
       34 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖);
       35 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess(result);
       36 Γöé + ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{
       37 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=
       38 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖Error┬╖?┬╖error.message┬╖:┬╖"Unknown┬╖error┬╖copying┬╖range";
       39 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);
       40 Γöé + ┬╖┬╖┬╖┬╖}
       41 Γöé + ┬╖┬╖},
       42 Γöé + });
    43 43 Γöé   
  

src\lib\tools\get-all-objects.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";ΓÉì
     2    Γöé - import┬╖{┬╖getAllObjects┬╖}┬╖from┬╖"../excel/api";ΓÉì
     3    Γöé - import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";ΓÉì
     4    Γöé - ΓÉì
     5    Γöé - export┬╖const┬╖getAllObjectsTool┬╖=┬╖defineTool({ΓÉì
     6    Γöé - ┬╖┬╖name:┬╖"get_all_objects",ΓÉì
     7    Γöé - ┬╖┬╖label:┬╖"Get┬╖All┬╖Objects",ΓÉì
     8    Γöé - ┬╖┬╖description:ΓÉì
     9    Γöé - ┬╖┬╖┬╖┬╖"List┬╖all┬╖charts,┬╖pivot┬╖tables,┬╖and┬╖other┬╖objects┬╖in┬╖the┬╖workbook.┬╖"┬╖+ΓÉì
    10    Γöé - ┬╖┬╖┬╖┬╖"Use┬╖this┬╖to┬╖discover┬╖what┬╖visualizations┬╖exist┬╖before┬╖modifying┬╖them.",ΓÉì
    11    Γöé - ┬╖┬╖parameters:┬╖Type.Object({ΓÉì
    12    Γöé - ┬╖┬╖┬╖┬╖sheetId:┬╖Type.Optional(ΓÉì
    13    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Type.Number({┬╖description:┬╖"Filter┬╖to┬╖specific┬╖sheet"┬╖}),ΓÉì
    14    Γöé - ┬╖┬╖┬╖┬╖),ΓÉì
    15    Γöé - ┬╖┬╖┬╖┬╖id:┬╖Type.Optional(Type.String({┬╖description:┬╖"Filter┬╖by┬╖object┬╖ID"┬╖})),ΓÉì
    16    Γöé - ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(ΓÉì
    17    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({ΓÉì
    18    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",ΓÉì
    19    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,ΓÉì
    20    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}),ΓÉì
    21    Γöé - ┬╖┬╖┬╖┬╖),ΓÉì
    22    Γöé - ┬╖┬╖}),ΓÉì
    23    Γöé - ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{ΓÉì
    24    Γöé - ┬╖┬╖┬╖┬╖try┬╖{ΓÉì
    25    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖getAllObjects({ΓÉì
    26    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖sheetId:┬╖params.sheetId,ΓÉì
    27    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖id:┬╖params.id,ΓÉì
    28    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖});ΓÉì
    29    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess(result);ΓÉì
    30    Γöé - ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{ΓÉì
    31    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=ΓÉì
    32    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖ErrorΓÉì
    33    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖?┬╖error.messageΓÉì
    34    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖:┬╖"Unknown┬╖error┬╖getting┬╖objects";ΓÉì
    35    Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);ΓÉì
    36    Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
    37    Γöé - ┬╖┬╖},ΓÉì
    38    Γöé - });ΓÉì
        1 Γöé + import┬╖{┬╖Type┬╖}┬╖from┬╖"@sinclair/typebox";
        2 Γöé + import┬╖{┬╖getAllObjects┬╖}┬╖from┬╖"../excel/api";
        3 Γöé + import┬╖{┬╖defineTool,┬╖toolError,┬╖toolSuccess┬╖}┬╖from┬╖"./types";
        4 Γöé + 
        5 Γöé + export┬╖const┬╖getAllObjectsTool┬╖=┬╖defineTool({
        6 Γöé + ┬╖┬╖name:┬╖"get_all_objects",
        7 Γöé + ┬╖┬╖label:┬╖"Get┬╖All┬╖Objects",
        8 Γöé + ┬╖┬╖description:
        9 Γöé + ┬╖┬╖┬╖┬╖"List┬╖all┬╖charts,┬╖pivot┬╖tables,┬╖and┬╖other┬╖objects┬╖in┬╖the┬╖workbook.┬╖"┬╖+
       10 Γöé + ┬╖┬╖┬╖┬╖"Use┬╖this┬╖to┬╖discover┬╖what┬╖visualizations┬╖exist┬╖before┬╖modifying┬╖them.",
       11 Γöé + ┬╖┬╖parameters:┬╖Type.Object({
       12 Γöé + ┬╖┬╖┬╖┬╖sheetId:┬╖Type.Optional(
       13 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Type.Number({┬╖description:┬╖"Filter┬╖to┬╖specific┬╖sheet"┬╖}),
       14 Γöé + ┬╖┬╖┬╖┬╖),
       15 Γöé + ┬╖┬╖┬╖┬╖id:┬╖Type.Optional(Type.String({┬╖description:┬╖"Filter┬╖by┬╖object┬╖ID"┬╖})),
       16 Γöé + ┬╖┬╖┬╖┬╖explanation:┬╖Type.Optional(
       17 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖Type.String({
       18 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖description:┬╖"Brief┬╖explanation┬╖(max┬╖50┬╖chars)",
       19 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖maxLength:┬╖50,
       20 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖}),
       21 Γöé + ┬╖┬╖┬╖┬╖),
       22 Γöé + ┬╖┬╖}),
       23 Γöé + ┬╖┬╖execute:┬╖async┬╖(_toolCallId,┬╖params)┬╖=>┬╖{
       24 Γöé + ┬╖┬╖┬╖┬╖try┬╖{
       25 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖result┬╖=┬╖await┬╖getAllObjects({
       26 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖sheetId:┬╖params.sheetId,
       27 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖id:┬╖params.id,
       28 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖});
       29 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolSuccess(result);
       30 Γöé + ┬╖┬╖┬╖┬╖}┬╖catch┬╖(error)┬╖{
       31 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖const┬╖message┬╖=
       32 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖error┬╖instanceof┬╖Error
       33 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖?┬╖error.message
       34 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖:┬╖"Unknown┬╖error┬╖getting┬╖objects";
       35 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖toolError(message);
       36 Γöé + ┬╖┬╖┬╖┬╖}
       37 Γöé + ┬╖┬╖},
       38 Γöé + });
    39 39 Γöé   
  

src\taskpane\components\chat\types.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
    1   Γöé - export┬╖type┬╖ChatTab┬╖=┬╖"chat"┬╖|┬╖"settings";ΓÉì
      1 Γöé + export┬╖type┬╖ChatTab┬╖=┬╖"chat"┬╖|┬╖"settings";
    2 2 Γöé   
  

src\taskpane\index.tsx format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
     1    Γöé - import┬╖{┬╖createRoot┬╖}┬╖from┬╖"react-dom/client";ΓÉì
     2    Γöé - import┬╖App┬╖from┬╖"./components/app";ΓÉì
     3    Γöé - import┬╖"./index.css";ΓÉì
     4    Γöé - ΓÉì
     5    Γöé - const┬╖title┬╖=┬╖"OpenExcel";ΓÉì
     6    Γöé - ΓÉì
     7    Γöé - const┬╖rootElement:┬╖HTMLElement┬╖|┬╖null┬╖=┬╖document.getElementById("container");ΓÉì
     8    Γöé - const┬╖root┬╖=┬╖rootElement┬╖?┬╖createRoot(rootElement)┬╖:┬╖undefined;ΓÉì
     9    Γöé - ΓÉì
    10    Γöé - Office.onReady(()┬╖=>┬╖{ΓÉì
    11    Γöé - ┬╖┬╖root?.render(<App┬╖title={title}┬╖/>);ΓÉì
    12    Γöé - });ΓÉì
        1 Γöé + import┬╖{┬╖createRoot┬╖}┬╖from┬╖"react-dom/client";
        2 Γöé + import┬╖App┬╖from┬╖"./components/app";
        3 Γöé + import┬╖"./index.css";
        4 Γöé + 
        5 Γöé + const┬╖title┬╖=┬╖"OpenExcel";
        6 Γöé + 
        7 Γöé + const┬╖rootElement:┬╖HTMLElement┬╖|┬╖null┬╖=┬╖document.getElementById("container");
        8 Γöé + const┬╖root┬╖=┬╖rootElement┬╖?┬╖createRoot(rootElement)┬╖:┬╖undefined;
        9 Γöé + 
       10 Γöé + Office.onReady(()┬╖=>┬╖{
       11 Γöé + ┬╖┬╖root?.render(<App┬╖title={title}┬╖/>);
       12 Γöé + });
    13 13 Γöé   
  

src\taskpane\lockdown.ts format ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Formatter would have printed the following content:
  
      1     Γöé - import┬╖"ses";ΓÉì
      2     Γöé - ΓÉì
      3     Γöé - /*┬╖global┬╖lockdown┬╖*/ΓÉì
      4     Γöé - ΓÉì
      5     Γöé - const┬╖PRESERVE_FUNCTION_PROPS┬╖=┬╖new┬╖Set(["length",┬╖"name",┬╖"prototype"]);ΓÉì
      6     Γöé - const┬╖OFFICE_FUNCTION_STUBS┬╖=┬╖new┬╖Set([ΓÉì
      7     Γöé - ┬╖┬╖"_validateParams",ΓÉì
      8     Γöé - ┬╖┬╖"_validateParameterCount",ΓÉì
      9     Γöé - ┬╖┬╖"_validateParameter",ΓÉì
     10     Γöé - ┬╖┬╖"_validateParameterType",ΓÉì
     11     Γöé - ]);ΓÉì
     12     Γöé - ΓÉì
     13     Γöé - function┬╖saveFunctionProperties():┬╖Map<string,┬╖unknown>┬╖{ΓÉì
     14     Γöé - ┬╖┬╖const┬╖saved┬╖=┬╖new┬╖Map<string,┬╖unknown>();ΓÉì
     15     Γöé - ┬╖┬╖for┬╖(const┬╖key┬╖of┬╖Object.getOwnPropertyNames(Function))┬╖{ΓÉì
     16     Γöé - ┬╖┬╖┬╖┬╖if┬╖(!PRESERVE_FUNCTION_PROPS.has(key))┬╖{ΓÉì
     17     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖saved.set(key,┬╖(Function┬╖as┬╖unknown┬╖as┬╖Record<string,┬╖unknown>)[key]);ΓÉì
     18     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     19     Γöé - ┬╖┬╖}ΓÉì
     20     Γöé - ┬╖┬╖return┬╖saved;ΓÉì
     21     Γöé - }ΓÉì
     22     Γöé - ΓÉì
     23     Γöé - function┬╖restoreFunctionProperties(saved:┬╖Map<string,┬╖unknown>)┬╖{ΓÉì
     24     Γöé - ┬╖┬╖if┬╖(saved.size┬╖===┬╖0)┬╖return;ΓÉì
     25     Γöé - ΓÉì
     26     Γöé - ┬╖┬╖const┬╖noop┬╖=┬╖()┬╖=>┬╖null;ΓÉì
     27     Γöé - ┬╖┬╖for┬╖(const┬╖key┬╖of┬╖OFFICE_FUNCTION_STUBS)┬╖{ΓÉì
     28     Γöé - ┬╖┬╖┬╖┬╖if┬╖(saved.has(key))┬╖saved.set(key,┬╖noop);ΓÉì
     29     Γöé - ┬╖┬╖}ΓÉì
     30     Γöé - ΓÉì
     31     Γöé - ┬╖┬╖const┬╖fn┬╖=┬╖globalThis.Function;ΓÉì
     32     Γöé - ΓÉì
     33     Γöé - ┬╖┬╖//┬╖Fast┬╖path:┬╖if┬╖Function┬╖is┬╖still┬╖extensible,┬╖define┬╖properties┬╖directlyΓÉì
     34     Γöé - ┬╖┬╖if┬╖(Object.isExtensible(fn))┬╖{ΓÉì
     35     Γöé - ┬╖┬╖┬╖┬╖try┬╖{ΓÉì
     36     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖for┬╖(const┬╖[key,┬╖value]┬╖of┬╖saved)┬╖{ΓÉì
     37     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Object.defineProperty(fn,┬╖key,┬╖{ΓÉì
     38     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖value,ΓÉì
     39     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖writable:┬╖false,ΓÉì
     40     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖enumerable:┬╖false,ΓÉì
     41     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖configurable:┬╖false,ΓÉì
     42     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖});ΓÉì
     43     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     44     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return;ΓÉì
     45     Γöé - ┬╖┬╖┬╖┬╖}┬╖catch┬╖{ΓÉì
     46     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖//┬╖Fall┬╖through┬╖to┬╖proxy┬╖pathΓÉì
     47     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
     48     Γöé - ┬╖┬╖}ΓÉì
     49     Γöé - ΓÉì
     50     Γöé - ┬╖┬╖//┬╖Slow┬╖path:┬╖Function┬╖is┬╖frozen┬╖by┬╖lockdown,┬╖wrap┬╖it┬╖in┬╖a┬╖ProxyΓÉì
     51     Γöé - ┬╖┬╖const┬╖desc┬╖=┬╖Object.getOwnPropertyDescriptor(globalThis,┬╖"Function");ΓÉì
     52     Γöé - ┬╖┬╖if┬╖(!desc┬╖||┬╖(!desc.writable┬╖&&┬╖!desc.configurable))┬╖{ΓÉì
     53     Γöé - ┬╖┬╖┬╖┬╖console.warn(ΓÉì
     54     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖"[lockdown]┬╖Cannot┬╖restore┬╖Function┬╖properties┬╖ΓÇö┬╖Function┬╖is┬╖neither┬╖writable┬╖nor┬╖configurable",ΓÉì
     55     Γöé - ┬╖┬╖┬╖┬╖);ΓÉì
     56     Γöé - ┬╖┬╖┬╖┬╖return;ΓÉì
     57     Γöé - ┬╖┬╖}ΓÉì
     58     Γöé - ΓÉì
     59     Γöé - ┬╖┬╖const┬╖proxy┬╖=┬╖new┬╖Proxy(fn,┬╖{ΓÉì
     60     Γöé - ┬╖┬╖┬╖┬╖get(target,┬╖prop,┬╖receiver)┬╖{ΓÉì
     61     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖saved.has(prop┬╖as┬╖string)ΓÉì
     62     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖?┬╖saved.get(prop┬╖as┬╖string)ΓÉì
     63     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖:┬╖Reflect.get(target,┬╖prop,┬╖receiver);ΓÉì
     64     Γöé - ┬╖┬╖┬╖┬╖},ΓÉì
     65     Γöé - ┬╖┬╖┬╖┬╖has(target,┬╖prop)┬╖{ΓÉì
     66     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖saved.has(prop┬╖as┬╖string)┬╖?┬╖true┬╖:┬╖Reflect.has(target,┬╖prop);ΓÉì
     67     Γöé - ┬╖┬╖┬╖┬╖},ΓÉì
     68     Γöé - ┬╖┬╖┬╖┬╖getOwnPropertyDescriptor(target,┬╖prop)┬╖{ΓÉì
     69     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖if┬╖(saved.has(prop┬╖as┬╖string))┬╖{ΓÉì
     70     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖return┬╖{ΓÉì
     71     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖value:┬╖saved.get(prop┬╖as┬╖string),ΓÉì
     72     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖writable:┬╖false,ΓÉì
     73     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖enumerable:┬╖false,ΓÉì
     74     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖configurable:┬╖true,ΓÉì
     75     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖};ΓÉì
     76     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖}ΓÉì
     77     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖return┬╖Reflect.getOwnPropertyDescriptor(target,┬╖prop);ΓÉì
     78     Γöé - ┬╖┬╖┬╖┬╖},ΓÉì
     79     Γöé - ┬╖┬╖});ΓÉì
     80     Γöé - ΓÉì
     81     Γöé - ┬╖┬╖Object.defineProperty(globalThis,┬╖"Function",┬╖{ΓÉì
     82     Γöé - ┬╖┬╖┬╖┬╖value:┬╖proxy,ΓÉì
     83     Γöé - ┬╖┬╖┬╖┬╖writable:┬╖desc.writable┬╖??┬╖false,ΓÉì
     84     Γöé - ┬╖┬╖┬╖┬╖configurable:┬╖desc.configurable┬╖??┬╖false,ΓÉì
     85     Γöé - ┬╖┬╖});ΓÉì
     86     Γöé - }ΓÉì
     87     Γöé - ΓÉì
     88     Γöé - let┬╖locked┬╖=┬╖false;ΓÉì
     89     Γöé - ΓÉì
     90     Γöé - export┬╖function┬╖ensureLockdown()┬╖{ΓÉì
     91     Γöé - ┬╖┬╖if┬╖(locked)┬╖return;ΓÉì
     92     Γöé - ┬╖┬╖try┬╖{ΓÉì
     93     Γöé - ┬╖┬╖┬╖┬╖const┬╖savedFnProps┬╖=┬╖saveFunctionProperties();ΓÉì
     94     Γöé - ┬╖┬╖┬╖┬╖lockdown({ΓÉì
     95     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖errorTaming:┬╖"unsafe",ΓÉì
     96     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖consoleTaming:┬╖"unsafe",ΓÉì
     97     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖overrideTaming:┬╖"severe",ΓÉì
     98     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖stackFiltering:┬╖"verbose",ΓÉì
     99     Γöé - ┬╖┬╖┬╖┬╖});ΓÉì
    100     Γöé - ┬╖┬╖┬╖┬╖locked┬╖=┬╖true;ΓÉì
    101     Γöé - ┬╖┬╖┬╖┬╖restoreFunctionProperties(savedFnProps);ΓÉì
    102     Γöé - ┬╖┬╖}┬╖catch┬╖(e)┬╖{ΓÉì
    103     Γöé - ┬╖┬╖┬╖┬╖if┬╖(ΓÉì
    104     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖e┬╖instanceof┬╖TypeError┬╖&&ΓÉì
    105     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖String(e).includes("SES_ALREADY_LOCKED_DOWN")ΓÉì
    106     Γöé - ┬╖┬╖┬╖┬╖)┬╖{ΓÉì
    107     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖locked┬╖=┬╖true;ΓÉì
    108     Γöé - ┬╖┬╖┬╖┬╖}┬╖else┬╖{ΓÉì
    109     Γöé - ┬╖┬╖┬╖┬╖┬╖┬╖throw┬╖e;ΓÉì
    110     Γöé - ┬╖┬╖┬╖┬╖}ΓÉì
    111     Γöé - ┬╖┬╖}ΓÉì
    112     Γöé - }ΓÉì
          1 Γöé + import┬╖"ses";
          2 Γöé + 
          3 Γöé + /*┬╖global┬╖lockdown┬╖*/
          4 Γöé + 
          5 Γöé + const┬╖PRESERVE_FUNCTION_PROPS┬╖=┬╖new┬╖Set(["length",┬╖"name",┬╖"prototype"]);
          6 Γöé + const┬╖OFFICE_FUNCTION_STUBS┬╖=┬╖new┬╖Set([
          7 Γöé + ┬╖┬╖"_validateParams",
          8 Γöé + ┬╖┬╖"_validateParameterCount",
          9 Γöé + ┬╖┬╖"_validateParameter",
         10 Γöé + ┬╖┬╖"_validateParameterType",
         11 Γöé + ]);
         12 Γöé + 
         13 Γöé + function┬╖saveFunctionProperties():┬╖Map<string,┬╖unknown>┬╖{
         14 Γöé + ┬╖┬╖const┬╖saved┬╖=┬╖new┬╖Map<string,┬╖unknown>();
         15 Γöé + ┬╖┬╖for┬╖(const┬╖key┬╖of┬╖Object.getOwnPropertyNames(Function))┬╖{
         16 Γöé + ┬╖┬╖┬╖┬╖if┬╖(!PRESERVE_FUNCTION_PROPS.has(key))┬╖{
         17 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖saved.set(key,┬╖(Function┬╖as┬╖unknown┬╖as┬╖Record<string,┬╖unknown>)[key]);
         18 Γöé + ┬╖┬╖┬╖┬╖}
         19 Γöé + ┬╖┬╖}
         20 Γöé + ┬╖┬╖return┬╖saved;
         21 Γöé + }
         22 Γöé + 
         23 Γöé + function┬╖restoreFunctionProperties(saved:┬╖Map<string,┬╖unknown>)┬╖{
         24 Γöé + ┬╖┬╖if┬╖(saved.size┬╖===┬╖0)┬╖return;
         25 Γöé + 
         26 Γöé + ┬╖┬╖const┬╖noop┬╖=┬╖()┬╖=>┬╖null;
         27 Γöé + ┬╖┬╖for┬╖(const┬╖key┬╖of┬╖OFFICE_FUNCTION_STUBS)┬╖{
         28 Γöé + ┬╖┬╖┬╖┬╖if┬╖(saved.has(key))┬╖saved.set(key,┬╖noop);
         29 Γöé + ┬╖┬╖}
         30 Γöé + 
         31 Γöé + ┬╖┬╖const┬╖fn┬╖=┬╖globalThis.Function;
         32 Γöé + 
         33 Γöé + ┬╖┬╖//┬╖Fast┬╖path:┬╖if┬╖Function┬╖is┬╖still┬╖extensible,┬╖define┬╖properties┬╖directly
         34 Γöé + ┬╖┬╖if┬╖(Object.isExtensible(fn))┬╖{
         35 Γöé + ┬╖┬╖┬╖┬╖try┬╖{
         36 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖for┬╖(const┬╖[key,┬╖value]┬╖of┬╖saved)┬╖{
         37 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖Object.defineProperty(fn,┬╖key,┬╖{
         38 Γöé + ┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖value,
  75 more lines truncated
  

The number of diagnostics exceeds the limit allowed. Use --max-diagnostics to increase it.
Diagnostics not shown: 26.
Checked 45 files in 197ms. No fixes applied.
Found 46 errors.
check ΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöüΓöü

  ├ù Some errors were emitted while running checks.
  

ΓÇëELIFECYCLEΓÇë Command failed with exit code 1.
